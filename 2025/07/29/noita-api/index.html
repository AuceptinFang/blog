<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>noita_api | Auceptin's Blog</title><meta name="author" content="Auceptin.Fang"><meta name="copyright" content="Auceptin.Fang"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="ffffff"><meta name="description" content="一个 noita API使用参考文档  noita的api只提供了参数和返回值，大多都没写具体效果，noita wiki里的差点意思，故有本文 lua_api_documentation.txt文件版本：Current modding API version: 12，共注明了405个，其中16个注明deprecated，本文忽略,当前进度：208&#x2F;389 开销测量因环境与上下文而异，仅供参考  调">
<meta property="og:type" content="article">
<meta property="og:title" content="noita_api">
<meta property="og:url" content="https://aucept.in/2025/07/29/noita-api/index.html">
<meta property="og:site_name" content="Auceptin&#39;s Blog">
<meta property="og:description" content="一个 noita API使用参考文档  noita的api只提供了参数和返回值，大多都没写具体效果，noita wiki里的差点意思，故有本文 lua_api_documentation.txt文件版本：Current modding API version: 12，共注明了405个，其中16个注明deprecated，本文忽略,当前进度：208&#x2F;389 开销测量因环境与上下文而异，仅供参考  调">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://aucept.in/image/cover27_chinapunk.jpg">
<meta property="article:published_time" content="2025-07-29T09:00:00.000Z">
<meta property="article:modified_time" content="2025-10-04T05:16:55.559Z">
<meta property="article:author" content="Auceptin.Fang">
<meta property="article:tag" content="lua">
<meta property="article:tag" content="noita">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://aucept.in/image/cover27_chinapunk.jpg"><script type="application/ld+json">{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "noita_api",
  "url": "https://aucept.in/2025/07/29/noita-api/",
  "image": "https://aucept.in/image/cover27_chinapunk.jpg",
  "datePublished": "2025-07-29T09:00:00.000Z",
  "dateModified": "2025-10-04T05:16:55.559Z",
  "author": [
    {
      "@type": "Person",
      "name": "Auceptin.Fang",
      "url": "https://aucept.in/"
    }
  ]
}</script><link rel="shortcut icon" href="/img/favicon.png"><link rel="canonical" href="https://aucept.in/2025/07/29/noita-api/index.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css"><script>
    (() => {
      
    const saveToLocal = {
      set: (key, value, ttl) => {
        if (!ttl) return
        const expiry = Date.now() + ttl * 86400000
        localStorage.setItem(key, JSON.stringify({ value, expiry }))
      },
      get: key => {
        const itemStr = localStorage.getItem(key)
        if (!itemStr) return undefined
        const { value, expiry } = JSON.parse(itemStr)
        if (Date.now() > expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return value
      }
    }

    window.btf = {
      saveToLocal,
      getScript: (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        Object.entries(attr).forEach(([key, val]) => script.setAttribute(key, val))
        script.onload = script.onreadystatechange = () => {
          if (!script.readyState || /loaded|complete/.test(script.readyState)) resolve()
        }
        script.onerror = reject
        document.head.appendChild(script)
      }),
      getCSS: (url, id) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onload = link.onreadystatechange = () => {
          if (!link.readyState || /loaded|complete/.test(link.readyState)) resolve()
        }
        link.onerror = reject
        document.head.appendChild(link)
      }),
      addGlobalFn: (key, fn, name = false, parent = window) => {
        if (!false && key.startsWith('pjax')) return
        const globalFn = parent.globalFn || {}
        globalFn[key] = globalFn[key] || {}
        globalFn[key][name || Object.keys(globalFn[key]).length] = fn
        parent.globalFn = globalFn
      }
    }
  
      
      const activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      const activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', 'ffffff')
        }
      }

      btf.activateDarkMode = activateDarkMode
      btf.activateLightMode = activateLightMode

      const theme = saveToLocal.get('theme')
    
          theme === 'dark' ? activateDarkMode() : theme === 'light' ? activateLightMode() : null
        
      
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        document.documentElement.classList.toggle('hide-aside', asideStatus === 'hide')
      }
    
      
    const detectApple = () => {
      if (/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)) {
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
  
    })()
  </script><script>const GLOBAL_CONFIG = {
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  translate: undefined,
  highlight: {"plugin":"highlight.js","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false,"highlightFullpage":false,"highlightMacStyle":false},
  copy: {
    success: '复制成功',
    error: '复制失败',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  dateSuffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'null',
  Snackbar: undefined,
  infinitegrid: {
    js: 'https://cdn.jsdelivr.net/npm/@egjs/infinitegrid/dist/infinitegrid.min.js',
    buttonText: '加载更多'
  },
  isPhotoFigcaption: false,
  islazyloadPlugin: false,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: false,
  },
  autoDarkmode: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'noita_api',
  isHighlightShrink: false,
  isToc: true,
  pageType: 'post'
}</script><style>
  /* 数学公式美化样式 */
  .MathJax_Display {
    margin: 1.5em 0 !important;
    text-align: center !important;
  }
  
  .MathJax {
    font-size: 1.1em !important;
  }
  
  /* 行内公式样式 */
  .MathJax_Preview {
    color: inherit;
  }
  
  /* 块级公式容器美化 */
  .MathJax_Display {
    background: rgba(0,0,0,0.02);
    border-radius: 8px;
    padding: 15px 20px;
    margin: 20px 0;
    box-shadow: 0 2px 8px rgba(0,0,0,0.1);
    border-left: 4px solid #49b1f5;
  }
  
  /* 暗色模式下的公式样式 */
  [data-theme="dark"] .MathJax_Display {
    background: rgba(255,255,255,0.05);
    border-left-color: #1f2937;
    box-shadow: 0 2px 8px rgba(0,0,0,0.3);
  }
  
  /* 公式编号样式 */
  .MathJax .mjx-math .mjx-mrow .mjx-mtable .mjx-label {
    color: #666;
    font-size: 0.9em;
  }
  
  /* 提升公式清晰度 */
  .MathJax svg {
    max-width: 100% !important;
    height: auto !important;
  }
</style>
<meta name="generator" content="Hexo 7.3.0"></head><body><div id="web_bg" style="background-color: #f5f5f5;"></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img text-center"><img src="/img/auceptin-icon.png" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="site-data text-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">29</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">27</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">8</div></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><span> Categories</span></a></div><div class="menus_item"><a class="site-page" href="/friends/"><span> Friends</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url(/image/cover2_square.png);"><nav id="nav"><span id="blog-info"><a class="nav-site-title" href="/"><span class="site-name">Auceptin's Blog</span></a><a class="nav-page-title" href="/"><span class="site-name">noita_api</span></a></span><div id="menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><span> Categories</span></a></div><div class="menus_item"><a class="site-page" href="/friends/"><span> Friends</span></a></div></div><div id="toggle-menu"><span class="site-page"><i class="fas fa-bars fa-fw"></i></span></div></div></nav><div id="post-info"><h1 class="post-title">noita_api</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2025-07-29T09:00:00.000Z" title="发表于 2025-07-29 17:00:00">2025-07-29</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2025-10-04T05:16:55.559Z" title="更新于 2025-10-04 13:16:55">2025-10-04</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/noita/">noita</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title=""><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">浏览量:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="container post-content" id="article-container"><p><span style = "font-size: 30px; font-weight: 900">一个 noita API使用参考文档 </span></p>
<p>noita的api只提供了参数和返回值，大多都没写具体效果，<a target="_blank" rel="noopener" href="https://noita.wiki.gg/zh/wiki/Mod:Lua_API">noita wiki</a>里的差点意思，故有本文</p>
<p>lua_api_documentation.txt文件版本：<code>Current modding API version: 12</code>，共注明了405个，其中16个注明deprecated，本文忽略,当前进度：208/389</p>
<div class="note danger flat"><p>开销测量因环境与上下文而异，仅供参考</p>
</div>
<h2 id="调试相关"><a href="#调试相关" class="headerlink" title="调试相关"></a>调试相关</h2><h3 id="GamePrint"><a href="#GamePrint" class="headerlink" title="GamePrint"></a><code>GamePrint</code></h3><blockquote>
<p>GamePrint( log_line:string )</p>
</blockquote>
<p>参数是一个字符串（数字也可以），效果为在游戏左下角输出，测得开销约为0.9秒/百万次。noita每秒60帧，也就是每帧16毫秒，不到20000次输出</p>
<p>属于比较轻量的输出，每帧调用几千次不会造成明显影响</p>
<h3 id="GamePrintImportant"><a href="#GamePrintImportant" class="headerlink" title="GamePrintImportant"></a><code>GamePrintImportant</code></h3><blockquote>
<p>GamePrintImportant( title:string, description:string = “”, ui_custom_decoration_file:string = “” )</p>
</blockquote>
<p>三个字符串参数，标题、描述和ui装饰</p>
<p>第一个显示在框里，触怒神明等，第二个显示在框下，第三个改变框的ui，默认为触怒神明时的那种，需要一个图片的路径，如：”data/ui_gfx/decorations/3piece_fungal_shift.png”可以换为真菌转化的ui</p>
<p>有几秒的固定持续时间，不会被后来的覆盖掉，超出一定时间限制的会被丢弃</p>
<h3 id="GameGetRealWorldTimeSinceStarted"><a href="#GameGetRealWorldTimeSinceStarted" class="headerlink" title="GameGetRealWorldTimeSinceStarted"></a><code>GameGetRealWorldTimeSinceStarted</code></h3><blockquote>
<p>GameGetRealWorldTimeSinceStarted() -&gt; number</p>
</blockquote>
<p>返回自游戏开始的时间，单位是秒，小数点后保留7位</p>
<h3 id="GameGetFrameNum"><a href="#GameGetFrameNum" class="headerlink" title="GameGetFrameNum"></a><code>GameGetFrameNum</code></h3><blockquote>
<p>GameGetFrameNum() -&gt; int</p>
</blockquote>
<p>返回一个整数，游戏开始到当前的帧数（每秒上限60帧）</p>
<h3 id="GameGetDateAndTimeUTC"><a href="#GameGetDateAndTimeUTC" class="headerlink" title="GameGetDateAndTimeUTC"></a><code>GameGetDateAndTimeUTC</code></h3><blockquote>
<p>GameGetDateAndTimeUTC() -&gt; year:int,month:int,day:int,hour:int,minute:int,second:int</p>
</blockquote>
<p>返回六个整数，获取UTC日期时间</p>
<h3 id="GameGetDateAndTimeLocal"><a href="#GameGetDateAndTimeLocal" class="headerlink" title="GameGetDateAndTimeLocal"></a><code>GameGetDateAndTimeLocal</code></h3><blockquote>
<p>GameGetDateAndTimeLocal() -&gt;year:int,month:int,day:int,hour:int,minute:int,second:int</p>
</blockquote>
<p>同上，获取本地时间</p>
<h3 id="SetTimeOut"><a href="#SetTimeOut" class="headerlink" title="SetTimeOut"></a><code>SetTimeOut</code></h3><blockquote>
<p>SetTimeOut( time_to_execute:number, file_to_execute:string, function_to_call:string = nil )</p>
</blockquote>
<p>%rdi秒后执行，参数为：时间（秒），文件路径（绝对路径），要执行的文件里的函数名</p>
<p>使用参考：<br><figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SetTimeOut( <span class="number">0.54</span>, <span class="string">&quot;data/scripts/buildings/egg_damage.lua&quot;</span>, <span class="string">&quot;impl_spawn_boss_dragon&quot;</span>)</span><br></pre></td></tr></table></figure><br>注1：此函数运行是非阻塞的，即执行到该函数时开始计时并立刻返回，计时完成后执行函数</p>
<p>注2：此函数具备跨存档特性，只要时间到了就执行，即使已经新开了一局（如果函数还能找到的话）</p>
<h3 id="SetWorldSeed"><a href="#SetWorldSeed" class="headerlink" title="SetWorldSeed"></a><code>SetWorldSeed</code></h3><blockquote>
<p>SetWorldSeed( new_seed:int )</p>
</blockquote>
<p>设置世界的种子</p>
<h3 id="SetPlayerSpawnLocation"><a href="#SetPlayerSpawnLocation" class="headerlink" title="SetPlayerSpawnLocation"></a><code>SetPlayerSpawnLocation</code></h3><blockquote>
<p>SetPlayerSpawnLocation( x:number, y:number )</p>
</blockquote>
<p>设置出生点，输入坐标</p>
<h3 id="SetRandomSeed"><a href="#SetRandomSeed" class="headerlink" title="SetRandomSeed"></a><code>SetRandomSeed</code></h3><blockquote>
<p>SetRandomSeed( x:number, y:number )</p>
</blockquote>
<p>设置随机种子，参数选择坐标、时间、实体id或无意义数字等均可</p>
<h3 id="DEBUG-GetMouseWorld"><a href="#DEBUG-GetMouseWorld" class="headerlink" title="DEBUG_GetMouseWorld"></a><code>DEBUG_GetMouseWorld</code></h3><blockquote>
<p>DEBUG_GetMouseWorld() -&gt; x:number,y:number</p>
</blockquote>
<p>获取鼠标在世界地图上的坐标，返回一对坐标</p>
<h3 id="DEBUG-MARK"><a href="#DEBUG-MARK" class="headerlink" title="DEBUG_MARK"></a><code>DEBUG_MARK</code></h3><blockquote>
<p>DEBUG_MARK( x:number, y:number, message:string = “”, color_r:number = 1, color_g:number = 0, color_b:number = 0 )</p>
</blockquote>
<p>标记，输入在屏幕上的坐标，字符串，颜色（RGB）</p>
<h2 id="实体Entity……"><a href="#实体Entity……" class="headerlink" title="实体Entity……"></a>实体Entity……</h2><h3 id="EntityLoad"><a href="#EntityLoad" class="headerlink" title="EntityLoad"></a><code>EntityLoad</code></h3><blockquote>
<p>EntityLoad( filename:string, pos_x:number = 0, pos_y:number = 0 ) -&gt; entity_id:int</p>
</blockquote>
<p>生成一个实体，参数为一个xml文件路径和两个坐标，返回entity_id，实体的标识符，可以以此跟踪该实体</p>
<p>生成开销（每百次毫秒级）远小于后续计算实体行为开销</p>
<p>生物数量有上限：<br><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">CameraBoundComponent</span> </span></span><br><span class="line"><span class="tag">        <span class="attr">max_count</span>=<span class="string">&quot;20&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">distance</span>=<span class="string">&quot;160000&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">CameraBoundComponent</span>&gt;</span></span><br></pre></td></tr></table></figure><br>在相机界限组件内定义</p>
<h3 id="EntityLoadEndGameItem"><a href="#EntityLoadEndGameItem" class="headerlink" title="EntityLoadEndGameItem"></a><code>EntityLoadEndGameItem</code></h3><blockquote>
<p>EntityLoadEndGameItem( filename:string, pos_x:number = 0, pos_y:number = 0 ) -&gt; entity_id:int</p>
</blockquote>
<p>一个很神秘的api，测试中和EntityLoad基本一致，游戏中唯一可见的用法是：<br><figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>( Random( <span class="number">0</span>, <span class="number">100000</span>) &gt;= <span class="number">100000</span> ) <span class="keyword">then</span></span><br><span class="line">	EntityLoadEndGameItem( <span class="string">&quot;data/entities/animals/boss_centipede/sampo.xml&quot;</span>, x, y )</span><br><span class="line">	count = <span class="number">0</span></span><br><span class="line">	<span class="keyword">return</span> </span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure><br>该函数效果是会在正常生成sampo之后再生成一个宝箱</p>
<h3 id="EntityKill"><a href="#EntityKill" class="headerlink" title="EntityKill"></a><code>EntityKill</code></h3><blockquote>
<p>EntityKill( entity_id:int )</p>
</blockquote>
<p>清除指定id的实体，无尸体、无掉落</p>
<h3 id="EntityCreateNew"><a href="#EntityCreateNew" class="headerlink" title="EntityCreateNew"></a><code>EntityCreateNew</code></h3><blockquote>
<p>EntityCreateNew( name:string = “” ) -&gt; entity_id:int</p>
</blockquote>
<p>创建一个实体，参数为实体名，可留空，返回id，搭配其它操作实体的函数使用，例：<br><figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- add ui icon etc</span></span><br><span class="line"><span class="keyword">local</span> entity_ui = EntityCreateNew( <span class="string">&quot;&quot;</span> )</span><br><span class="line">EntityAddComponent( entity_ui, <span class="string">&quot;UIIconComponent&quot;</span>, </span><br><span class="line">&#123; </span><br><span class="line">	name = essence_name,</span><br><span class="line">	description = essence_desc,</span><br><span class="line">	icon_sprite_file = ui_icon</span><br><span class="line">&#125;)</span><br><span class="line">EntityAddTag( entity_ui, <span class="string">&quot;essence_effect&quot;</span> )</span><br><span class="line">EntityAddChild( entity_who_picked, entity_ui )</span><br></pre></td></tr></table></figure></p>
<h3 id="EntityLoadCameraBound"><a href="#EntityLoadCameraBound" class="headerlink" title="EntityLoadCameraBound"></a><code>EntityLoadCameraBound</code></h3><blockquote>
<p>EntityLoadCameraBound( filename:string, pos_x:number = 0, pos_y:number = 0 )</p>
</blockquote>
<p>输入一个xml路径，一对坐标，不返回实体id。在对应坐标处生成一个指定实体，除无返回值外未观察到与EntityLoad的区别，开销相近，游戏文件中不常见</p>
<h3 id="EntityGetWithTag"><a href="#EntityGetWithTag" class="headerlink" title="EntityGetWithTag"></a><code>EntityGetWithTag</code></h3><blockquote>
<p>EntityGetWithTag( tag:string ) -&gt; {entity_id:int} <strong>[Returns all entities with ‘tag’.]</strong></p>
</blockquote>
<p>获取带有指定标签的实体，参数是标签，nolla备注说返回的是所有实体（id）</p>
<p>tags可以在实体的xml文件里看到：<br><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">Entity</span> </span></span><br><span class="line"><span class="tag">  <span class="attr">name</span>=<span class="string">&quot;DEBUG_NAME:player&quot;</span></span></span><br><span class="line"><span class="tag">  <span class="attr">tags</span>=<span class="string">&quot;mortal,human,hittable,peasant,prey,player_unit,teleportable&quot;</span> &gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">Entity</span>&gt;</span></span><br></pre></td></tr></table></figure><br>寻找玩家就可以：</p>
<blockquote>
<p>EntityGetWithTag( “player_unit” )<br>得到玩家表，第一项即玩家的实体id</p>
</blockquote>
<p>有一定的检测范围，大于视野很多</p>
<h3 id="EntityGetInRadius"><a href="#EntityGetInRadius" class="headerlink" title="EntityGetInRadius"></a><code>EntityGetInRadius</code></h3><blockquote>
<p>EntityGetInRadius( pos_x:number, pos_y:number, radius:number ) -&gt; {entity_id:int} [Returns all entities in ‘radius’ distance from ‘x’,’y’.]</p>
</blockquote>
<p>输入坐标和半径，返回所有实体id。检测范围存在上限，半径约为1000像素（有待精确测量）</p>
<h3 id="EntityGetInRadiusWithTag"><a href="#EntityGetInRadiusWithTag" class="headerlink" title="EntityGetInRadiusWithTag"></a><code>EntityGetInRadiusWithTag</code></h3><blockquote>
<p>EntityGetInRadiusWithTag( pos_x:number, pos_y:number, radius:number, entity_tag:string ) -&gt; {entity_id:int} [Returns all entities in ‘radius’ distance from ‘x’,’y’.]</p>
</blockquote>
<p>输入一对坐标，实体id和一个标签，前两个的结合</p>
<h3 id="EntityGetClosest"><a href="#EntityGetClosest" class="headerlink" title="EntityGetClosest"></a><code>EntityGetClosest</code></h3><blockquote>
<p>EntityGetClosest( pos_x:number, pos_y:number ) -&gt; entity_id:int</p>
</blockquote>
<p>获取具体给定坐标最近的实体id，输入一对坐标，返回id</p>
<h3 id="EntityGetClosestWithTag"><a href="#EntityGetClosestWithTag" class="headerlink" title="EntityGetClosestWithTag"></a><code>EntityGetClosestWithTag</code></h3><blockquote>
<p>EntityGetClosestWithTag(  pos_x:number, pos_y:number, tag:string ) -&gt; entity_id:int</p>
</blockquote>
<p>获取最近的带有某标签的实体，输入坐标、标签，返回id</p>
<h3 id="EntityGetWithName"><a href="#EntityGetWithName" class="headerlink" title="EntityGetWithName"></a><code>EntityGetWithName</code></h3><blockquote>
<p>EntityGetWithName( name:string ) -&gt; entity_id:int</p>
</blockquote>
<p>输入name，返回id。name类似于以下，是实体的名字，受汉化影响。（此api在游戏文件里一次也没用过）<br><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">Entity</span> <span class="attr">name</span>=<span class="string">&quot;$projectile_default&quot;</span> <span class="attr">tags</span>=<span class="string">&quot;projectile_player&quot;</span> &gt;</span> <span class="tag">&lt;/<span class="name">Entity</span>&gt;</span></span><br></pre></td></tr></table></figure></p>
<h3 id="EntityGetTransform"><a href="#EntityGetTransform" class="headerlink" title="EntityGetTransform"></a><code>EntityGetTransform</code></h3><blockquote>
<p>EntityGetTransform( entity_id:int ) -&gt; x:number,y:number,rotation:number,scale_x:number,scale_y:number</p>
</blockquote>
<p>用于获取实体位置，输入实体id</p>
<p>前俩返回值是坐标，rotation是贴图的旋转角度，单位是弧度，0为正，顺时针，scale_x和y是贴图的缩放倍数，负数为翻转</p>
<h3 id="EntitySetTransform"><a href="#EntitySetTransform" class="headerlink" title="EntitySetTransform"></a><code>EntitySetTransform</code></h3><blockquote>
<p>EntitySetTransform( entity_id:int, x:number, y:number = 0, rotation:number = 0, scale_x:number = 1, scale_y:number = 1 )</p>
</blockquote>
<p>设置实体状态，id，坐标，贴图顺时针选择弧度，贴图缩放，-1翻转</p>
<h3 id="EntityApplyTransform"><a href="#EntityApplyTransform" class="headerlink" title="EntityApplyTransform"></a><code>EntityApplyTransform</code></h3><blockquote>
<p>EntityApplyTransform( entity_id:int, x:number, y:number = 0, rotation:number = 0, scale_x:number = 1, scale_y:number = 1 )  [Sets the transform and tries to immediately refresh components that calculate values based on an entity’s transform.]</p>
</blockquote>
<p>用法同上，立即更新依赖组件</p>
<h3 id="EntityGetName"><a href="#EntityGetName" class="headerlink" title="EntityGetName"></a><code>EntityGetName</code></h3><blockquote>
<p>EntityGetName( entity_id:int ) -&gt; name:string</p>
</blockquote>
<p>输入id，返回name（字符串）</p>
<h3 id="EntitySetName"><a href="#EntitySetName" class="headerlink" title="EntitySetName"></a><code>EntitySetName</code></h3><blockquote>
<p>EntitySetName( entity_id:int, name:string )</p>
</blockquote>
<p>输入id和name，无返回值</p>
<h3 id="EntityGetTags"><a href="#EntityGetTags" class="headerlink" title="EntityGetTags"></a><code>EntityGetTags</code></h3><blockquote>
<p>EntityGetTags( entity_id:int ) -&gt; string|nil [Returns a string where the tags are comma-separated, or nil if ‘entity_id’ doesn’t point to a valid entity.]</p>
</blockquote>
<p>输入id，返回标签（一个字符串）。备注说返回的标签以字符串分割，id无效返回nil</p>
<h3 id="EntityAddTag"><a href="#EntityAddTag" class="headerlink" title="EntityAddTag"></a><code>EntityAddTag</code></h3><blockquote>
<p>EntityAddTag( entity_id:int, tag:string )</p>
</blockquote>
<p>输入实体id，字符串，追加到原有标签末尾</p>
<h3 id="EntityRemoveTag"><a href="#EntityRemoveTag" class="headerlink" title="EntityRemoveTag"></a><code>EntityRemoveTag</code></h3><blockquote>
<p>EntityRemoveTag( entity_id:int, tag:string )</p>
</blockquote>
<p>移除标签，输入实体id，待移除的标签名</p>
<h3 id="EntityHasTag"><a href="#EntityHasTag" class="headerlink" title="EntityHasTag"></a><code>EntityHasTag</code></h3><blockquote>
<p>EntityHasTag( entity_id:int, tag:string ) -&gt; bool</p>
</blockquote>
<p>判断实体是否具有标签，返回一个bool值</p>
<h3 id="EntityGetFilename"><a href="#EntityGetFilename" class="headerlink" title="EntityGetFilename"></a><code>EntityGetFilename</code></h3><blockquote>
<p>EntityGetFilename( entity_id:int ) -&gt; full_path:string [Return value example: ‘data/entities/items/flute.xml’. Incorrect value is returned if the entity has passed through the world streaming system.]</p>
</blockquote>
<p>输入id，返回一个文件路径名</p>
<h3 id="EntitiesGetMaxID"><a href="#EntitiesGetMaxID" class="headerlink" title="EntitiesGetMaxID"></a><code>EntitiesGetMaxID</code></h3><blockquote>
<p>EntitiesGetMaxID() -&gt; entity_max_id:number [Returns the max entity ID currently in use. Entity IDs are increased linearly. ]</p>
</blockquote>
<p>无参数，返回在用的最大id</p>
<h3 id="EntityGetIsAlive"><a href="#EntityGetIsAlive" class="headerlink" title="EntityGetIsAlive"></a><code>EntityGetIsAlive</code></h3><blockquote>
<p>EntityGetIsAlive( entity_id:int ) -&gt; bool</p>
</blockquote>
<p>输入实体id，返回bool值，是否活着</p>
<h3 id="EntityAddComponent"><a href="#EntityAddComponent" class="headerlink" title="EntityAddComponent"></a><code>EntityAddComponent</code></h3><blockquote>
<p>EntityAddComponent( entity_id:int, component_type_name:string, table_of_component_values:{string} = nil ) -&gt; component_id:int</p>
</blockquote>
<p>为实体增加组件，输入实体id，组件名，一个该组件的属性表（键值对），返回组件id（唯一地标识该实体的改组件）</p>
<p>使用参考：<br><figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">EntityAddComponent( projectile_id, <span class="string">&quot;HomingComponent&quot;</span>, </span><br><span class="line">	&#123; </span><br><span class="line">		target_tag = <span class="string">&quot;projectile_commander&quot;</span>,</span><br><span class="line">		homing_targeting_coeff = <span class="string">&quot;200&quot;</span>,</span><br><span class="line">		homing_velocity_multiplier = <span class="string">&quot;1.0&quot;</span>,</span><br><span class="line">	&#125;)</span><br></pre></td></tr></table></figure></p>
<h3 id="EntityAddComponent2"><a href="#EntityAddComponent2" class="headerlink" title="EntityAddComponent2"></a><code>EntityAddComponent2</code></h3><blockquote>
<p>EntityAddComponent2( entity_id:int, component_type_name, table_of_component_values:{string-multiple_types} = nil ) -&gt; component_id [Creates a component of type ‘component_type_name’ and adds it to ‘entity_id’. ‘table_of_component_values’ should be a string-indexed table, where keys are field names and values are field values of correct type. The value setting works like ComponentObjectSetValue2(), with the exception that multivalue types are not supported. Additional supported values are _tags:comma_separated_string and _enabled:bool, which basically work like the those fields work in entity XML files. Returns the created component, if creation succeeded, or nil.</p>
</blockquote>
<p>参数与返回值同上，nolla备注说：创造一个组件并加到实体上，组件值表应该是一个键值对表，键是字段名，值是正确的类型。这个值设置运行就像ComponentObjectSetValue2()一样，除了不支持多种值类型。额外支持的值有_tags:comma_separated_string和 _enabled:bool，和其他xml文件里对应的字段效果一样</p>
<p>并没有解释和EntityAddComponent相比有什么区别，使用示例：<br><figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">EntityAddComponent2( text_id, <span class="string">&quot;SpriteComponent&quot;</span>,</span><br><span class="line">		&#123;</span><br><span class="line">			image_file=<span class="string">&quot;data/fonts/font_pixel_white.xml&quot;</span>,</span><br><span class="line">			is_text_sprite=<span class="literal">true</span>,</span><br><span class="line">			offset_x=<span class="number">12</span>,</span><br><span class="line">			offset_y=<span class="number">20</span>,</span><br><span class="line">			text = text, </span><br><span class="line">			update_transform=<span class="literal">true</span>,</span><br><span class="line">			update_transform_rotation=<span class="literal">false</span>,</span><br><span class="line">			has_special_scale=<span class="literal">true</span>,</span><br><span class="line">			special_scale_x=<span class="number">0.65</span>,</span><br><span class="line">			special_scale_y=<span class="number">0.65</span>,</span><br><span class="line">			alpha=<span class="number">0.5</span>,</span><br><span class="line">		&#125;)		</span><br></pre></td></tr></table></figure></p>
<h3 id="EntityRemoveComponent"><a href="#EntityRemoveComponent" class="headerlink" title="EntityRemoveComponent"></a><code>EntityRemoveComponent</code></h3><blockquote>
<p>EntityRemoveComponent( entity_id:int, component_id:int )</p>
</blockquote>
<p>移除组件，输入实体id和组件id，无返回</p>
<h3 id="EntityGetAllComponents"><a href="#EntityGetAllComponents" class="headerlink" title="EntityGetAllComponents"></a><code>EntityGetAllComponents</code></h3><blockquote>
<p>EntityGetAllComponents( entity_id:int ) -&gt; {int} [Returns a table of component ids.]</p>
</blockquote>
<p>获取实体的全部组件，输入实体id返回一个组件id表</p>
<p>使用示例：<br><figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- hamis here is a entity_id</span></span><br><span class="line"><span class="keyword">for</span> _,comp <span class="keyword">in</span> <span class="built_in">pairs</span>(EntityGetAllComponents(hamis)) <span class="keyword">do</span></span><br><span class="line">     GamePrint(comp)</span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure></p>
<h3 id="EntityGetComponent"><a href="#EntityGetComponent" class="headerlink" title="EntityGetComponent"></a><code>EntityGetComponent</code></h3><blockquote>
<p>EntityGetComponent( entity_id:int, component_type_name:string, tag:string = “” ) -&gt; {component_id}|nil</p>
</blockquote>
<p>获取特定组件，输入实体id，组件名，标签（可省略），返回一个组件id表</p>
<h3 id="EntityGetFirstComponent"><a href="#EntityGetFirstComponent" class="headerlink" title="EntityGetFirstComponent"></a><code>EntityGetFirstComponent</code></h3><blockquote>
<p>EntityGetFirstComponent( entity_id:int, component_type_name:string, tag:string = “” ) -&gt; component_id|nil</p>
</blockquote>
<p>获取第一个组件，输入实体id，组件名，标签（可省略），返回一个组件id</p>
<h3 id="EntityGetComponentIncludingDisabled"><a href="#EntityGetComponentIncludingDisabled" class="headerlink" title="EntityGetComponentIncludingDisabled"></a><code>EntityGetComponentIncludingDisabled</code></h3><blockquote>
<p>EntityGetComponentIncludingDisabled( entity_id:int, component_type_name:string, tag:string = “” ) -&gt; {component_id}|nil</p>
</blockquote>
<p>获取包含禁用的组件，输入实体id，组件名，标签（可省略），返回一个组件id表</p>
<h3 id="EntityGetFirstComponentIncludingDisabled"><a href="#EntityGetFirstComponentIncludingDisabled" class="headerlink" title="EntityGetFirstComponentIncludingDisabled"></a><code>EntityGetFirstComponentIncludingDisabled</code></h3><blockquote>
<p>EntityGetFirstComponentIncludingDisabled( entity_id:int, component_type_name:string, tag:string = “” ) -&gt; component_id|nil</p>
</blockquote>
<p>获取包含禁用的组件中的第一个，输入实体id，组件名，标签（可省略），返回一个组件id，参考：<br><figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">local</span> celleater = EntityGetFirstComponent( GetUpdatedEntityID(), <span class="string">&quot;CellEaterComponent&quot;</span> )</span><br></pre></td></tr></table></figure></p>
<h3 id="EntitySetComponentIsEnabled"><a href="#EntitySetComponentIsEnabled" class="headerlink" title="EntitySetComponentIsEnabled"></a><code>EntitySetComponentIsEnabled</code></h3><blockquote>
<p>EntitySetComponentIsEnabled( entity_id:int, component_id:int, is_enabled:bool )</p>
</blockquote>
<p>启用/禁用组件，输入实体id，组件id，和一个布尔值（启用/禁用）</p>
<h3 id="EntitySetComponentsWithTagEnabled"><a href="#EntitySetComponentsWithTagEnabled" class="headerlink" title="EntitySetComponentsWithTagEnabled"></a><code>EntitySetComponentsWithTagEnabled</code></h3><blockquote>
<p>EntitySetComponentsWithTagEnabled( entity_id:int, tag:string, enabled:bool )</p>
</blockquote>
<p>批量启用/禁用带特定标签的组件，输入实体id，标签名，启用/禁用</p>
<h3 id="EntityAddChild"><a href="#EntityAddChild" class="headerlink" title="EntityAddChild"></a><code>EntityAddChild</code></h3><blockquote>
<p>EntityAddChild( parent_id:int, child_id:int )</p>
</blockquote>
<p>给实体增加一个子实体，参数前父后子。</p>
<p>一个实体的构成除了组件以外还可以有别的实体，即子实体。大部分的天赋都是以这种形式添加的</p>
<h3 id="EntityGetAllChildren"><a href="#EntityGetAllChildren" class="headerlink" title="EntityGetAllChildren"></a><code>EntityGetAllChildren</code></h3><blockquote>
<p>EntityGetAllChildren( entity_id:int, tag:string = “” ) -&gt; {entity_id:int}|nil [If passed the optional ‘tag’ parameter, will return only child entities that have that tag (If ‘tag’ isn’t a valid tag name, will return no entities). If no entities are returned, might return either an empty table or nil.]</p>
</blockquote>
<p>查找指定实体的子实体，输入实体id、特定标签（可选，无则全部），返回一个实体id表或nil</p>
<h3 id="EntityGetParent"><a href="#EntityGetParent" class="headerlink" title="EntityGetParent"></a><code>EntityGetParent</code></h3><blockquote>
<p>EntityGetParent( entity_id:int ) -&gt; entity_id:int</p>
</blockquote>
<p>输入实体id，返回其父实体id</p>
<h3 id="EntityRemoveFromParent"><a href="#EntityRemoveFromParent" class="headerlink" title="EntityRemoveFromParent"></a><code>EntityRemoveFromParent</code></h3><blockquote>
<p>EntityRemoveFromParent( entity_id:int )</p>
</blockquote>
<p>输入实体id，从其父实体中移除</p>
<h3 id="EntityGetRootEntity"><a href="#EntityGetRootEntity" class="headerlink" title="EntityGetRootEntity"></a><code>EntityGetRootEntity</code></h3><blockquote>
<p>EntityGetRootEntity( entity_id:int ) -&gt; entity_id:int [Returns the given entity if it has no parent, otherwise walks up the parent hierarchy to the topmost parent and returns it.]</p>
</blockquote>
<p>获取根实体，输入id，返回最顶层的根实体id，如果没有根实体则返回自身</p>
<h3 id="EntityLoadToEntity"><a href="#EntityLoadToEntity" class="headerlink" title="EntityLoadToEntity"></a><code>EntityLoadToEntity</code></h3><blockquote>
<p>EntityLoadToEntity( filename:string, entity:int ) [Loads components from ‘filename’ to ‘entity’. Does not load tags and other stuff.]</p>
</blockquote>
<p>把一个文件的组件加载到一个实体上，不加载标签和其它，输入文件路径和实体id，例（念动力踢击天赋）：<br><figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">EntityLoadToEntity( <span class="string">&quot;data/entities/misc/perk_telekinesis.xml&quot;</span>, entity_who_picked )</span><br></pre></td></tr></table></figure><br><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- data/entities/misc/perk_telekinesis.xml --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">Entity</span>&gt;</span></span><br><span class="line">    </span><br><span class="line">  <span class="tag">&lt;<span class="name">TelekinesisComponent</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">TelekinesisComponent</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="tag">&lt;<span class="name">AudioLoopComponent</span></span></span><br><span class="line"><span class="tag">    <span class="attr">_tags</span>=<span class="string">&quot;sound_telekinesis_move&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">file</span>=<span class="string">&quot;data/audio/Desktop/misc.bank&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">event_name</span>=<span class="string">&quot;misc/telekinesis/object_move&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">volume_autofade_speed</span>=<span class="string">&quot;0.05&quot;</span></span></span><br><span class="line"><span class="tag">  &gt;</span> <span class="tag">&lt;/<span class="name">AudioLoopComponent</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="tag">&lt;<span class="name">AudioLoopComponent</span></span></span><br><span class="line"><span class="tag">    <span class="attr">_tags</span>=<span class="string">&quot;sound_telekinesis_hold&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">file</span>=<span class="string">&quot;data/audio/Desktop/misc.bank&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">event_name</span>=<span class="string">&quot;misc/telekinesis/hold&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">volume_autofade_speed</span>=<span class="string">&quot;0.05&quot;</span></span></span><br><span class="line"><span class="tag">  &gt;</span> <span class="tag">&lt;/<span class="name">AudioLoopComponent</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">Entity</span>&gt;</span></span><br></pre></td></tr></table></figure></p>
<p>随便替换组件会产生复杂的异常行为，有待进一步探索</p>
<h3 id="EntitySave"><a href="#EntitySave" class="headerlink" title="EntitySave"></a><code>EntitySave</code></h3><blockquote>
<p>EntitySave( entity_id:int, filename:string ) [Note: works only in dev builds.]</p>
</blockquote>
<p>保存实体为文件，输入实体id和保存到的文件路径，仅在开发者模式下可用，使用参考：<br><figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">--direector_helpers_design.lua</span></span><br><span class="line">entity_file = getPath( entity_file ) .. biome .. <span class="string">&quot;/&quot;</span> .. getFilename(entity_file)</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>( <span class="string">&quot;saving to&quot;</span>, getPath( entity_file ) )</span><br><span class="line">EntitySave( entity, entity_file  )</span><br></pre></td></tr></table></figure></p>
<h2 id="组件Component……"><a href="#组件Component……" class="headerlink" title="组件Component……"></a>组件Component……</h2><p>（从实体获取组件信息见实体部分）</p>
<h3 id="ComponentGetValue2"><a href="#ComponentGetValue2" class="headerlink" title="ComponentGetValue2"></a><code>ComponentGetValue2</code></h3><blockquote>
<p>ComponentGetValue2( component_id:int, field_name:string ) -&gt; multiple_types|nil [Returns one or many values matching the type or subtypes of the requested field. Reports error and returns nil if the field type is not supported or field was not found. This is up to 7.5x faster than the old ComponentSetValue functions.]</p>
</blockquote>
<p>获取组件的字段的值，输入组件id和字段名，返回匹配的所有值/nil</p>
<h3 id="ComponentSetValue2"><a href="#ComponentSetValue2" class="headerlink" title="ComponentSetValue2"></a><code>ComponentSetValue2</code></h3><blockquote>
<p>ComponentSetValue2( component_id:int, field_name:string, value_or_values:multiple_types ) [Sets the value of a field. Value(s) should have a type matching the field type. Reports error if the values weren’t given in correct type, the field type is not supported, or the component does not exist. This is up to 20x faster than the old ComponentSetValue functions.]</p>
</blockquote>
<p>设置组件字段，输入组件id，字段名，值。</p>
<h3 id="ComponentObjectGetValue2"><a href="#ComponentObjectGetValue2" class="headerlink" title="ComponentObjectGetValue2"></a><code>ComponentObjectGetValue2</code></h3><blockquote>
<p>ComponentObjectGetValue2( component_id:int, object_name:string, field_name:string ) -&gt; multiple types|nil [Returns one or many values matching the type or subtypes of the requested field in a component subobject. Reports error and returns nil if the field type is not supported or ‘object_name’ is not a metaobject.]</p>
</blockquote>
<p>获取object的值，输入组件id，对象名，字段名，返回值</p>
<p>一个组件的属性可能是标签，比如：<br><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"> <span class="tag">&lt;<span class="name">DamageModelComponent</span> </span></span><br><span class="line"><span class="tag"><span class="attr">hp</span>=<span class="string">&quot;10&quot;</span></span></span><br><span class="line"><span class="tag"><span class="attr">max_hp</span>=<span class="string">&quot;50&quot;</span></span></span><br><span class="line"><span class="tag"><span class="attr">materials_create_messages</span>=<span class="string">&quot;1&quot;</span></span></span><br><span class="line"><span class="tag"><span class="attr">ragdoll_filenames_file</span>=<span class="string">&quot;&quot;</span> </span></span><br><span class="line"><span class="tag"><span class="attr">fire_probability_of_ignition</span>=<span class="string">&quot;0&quot;</span></span></span><br><span class="line"><span class="tag"><span class="attr">ragdoll_fx_forced</span>=<span class="string">&quot;DISINTEGRATED&quot;</span></span></span><br><span class="line"><span class="tag"><span class="attr">ragdoll_material</span>=<span class="string">&quot;rock_static_glow&quot;</span></span></span><br><span class="line"><span class="tag"><span class="attr">minimum_knockback_force</span>=<span class="string">&quot;1000&quot;</span></span></span><br><span class="line"><span class="tag"><span class="attr">materials_that_damage</span>=<span class="string">&quot;&quot;</span> </span></span><br><span class="line"><span class="tag"><span class="attr">materials_how_much_damage</span>=<span class="string">&quot;&quot;</span></span></span><br><span class="line"><span class="tag">&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">damage_multipliers</span></span></span><br><span class="line"><span class="tag">	<span class="attr">melee</span>=<span class="string">&quot;0.3&quot;</span></span></span><br><span class="line"><span class="tag">	<span class="attr">projectile</span>=<span class="string">&quot;0.5&quot;</span></span></span><br><span class="line"><span class="tag">	<span class="attr">explosion</span>=<span class="string">&quot;1.0&quot;</span></span></span><br><span class="line"><span class="tag">	<span class="attr">electricity</span>=<span class="string">&quot;1.0&quot;</span></span></span><br><span class="line"><span class="tag">	<span class="attr">ice</span>=<span class="string">&quot;1.0&quot;</span></span></span><br><span class="line"><span class="tag">	<span class="attr">fire</span>=<span class="string">&quot;0.1&quot;</span> &gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">damage_multipliers</span>&gt;</span></span><br><span class="line"> <span class="tag">&lt;/<span class="name">DamageModelComponent</span>&gt;</span></span><br></pre></td></tr></table></figure><br>获取深层标签(damage_multipliers)的值就可以用如下的方法：<br><figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">local</span> fire_damage = ComponentObjectGetValue2(comp_id, <span class="string">&quot;damage_multipliers&quot;</span>, <span class="string">&quot;fire&quot;</span>)</span><br></pre></td></tr></table></figure></p>
<h3 id="ComponentObjectSetValue2"><a href="#ComponentObjectSetValue2" class="headerlink" title="ComponentObjectSetValue2"></a><code>ComponentObjectSetValue2</code></h3><blockquote>
<p>ComponentObjectSetValue2( component_id:int, object_name:string, field_name:string, value_or_values:multiple_types ) [Sets the value of a field in a component subobject. Value(s) should have a type matching the field type. Reports error if the values weren’t given in correct type, the field type is not supported or ‘object_name’ is not a metaobject.]</p>
</blockquote>
<p>输入组件id，对象名，字段名，值，例：<br><figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ComponentObjectSetValue2(damagemodel_comp, <span class="string">&quot;damage_multipliers&quot;</span>, <span class="string">&quot;melee&quot;</span>, <span class="number">1.5</span>)</span><br></pre></td></tr></table></figure></p>
<h3 id="ComponentAddTag"><a href="#ComponentAddTag" class="headerlink" title="ComponentAddTag"></a><code>ComponentAddTag</code></h3><blockquote>
<p>ComponentAddTag( component_id:int, tag:string )</p>
</blockquote>
<p>给组件加标签，输入组件id和标签名，无返回值</p>
<h3 id="ComponentRemoveTag"><a href="#ComponentRemoveTag" class="headerlink" title="ComponentRemoveTag"></a><code>ComponentRemoveTag</code></h3><blockquote>
<p>ComponentRemoveTag( component_id:int, tag:string )</p>
</blockquote>
<p>移除组件标签，输入组件id和标签名，无返回值</p>
<h3 id="ComponentGetTags"><a href="#ComponentGetTags" class="headerlink" title="ComponentGetTags"></a><code>ComponentGetTags</code></h3><blockquote>
<p>ComponentGetTags( component_id:int ) -&gt; string|nil [Returns a string where the tags are comma-separated, or nil if can’t find ‘component_id’ component.]</p>
</blockquote>
<p>输入组件id，返回用逗号分隔的一整个标签字符串，组件id不存在时返回nil</p>
<h3 id="ComponentHasTag"><a href="#ComponentHasTag" class="headerlink" title="ComponentHasTag"></a><code>ComponentHasTag</code></h3><blockquote>
<p>ComponentHasTag( component_id:int, tag:string ) -&gt; bool</p>
</blockquote>
<p>组件是否具有标签，输入组件id和标签名，返回一个bool值</p>
<h3 id="ComponentGetIsEnabled"><a href="#ComponentGetIsEnabled" class="headerlink" title="ComponentGetIsEnabled"></a><code>ComponentGetIsEnabled</code></h3><blockquote>
<p>ComponentGetIsEnabled( component_id:int ) -&gt; bool [Returns true if the given component exists and is enabled, else false.]</p>
</blockquote>
<p>获取组件是否可用，输入组件id返回bool值。</p>
<p>注：设置组件禁用与否用EntitySetComponentIsEnabled和EntitySetComponentsWithTagEnabled</p>
<h3 id="ComponentGetEntity"><a href="#ComponentGetEntity" class="headerlink" title="ComponentGetEntity"></a><code>ComponentGetEntity</code></h3><blockquote>
<p>ComponentGetEntity( component_id:int ) -&gt; entity_id:int [Returns the id of the entity that owns a component, or 0.]</p>
</blockquote>
<p>获取拥有特定组件的实体，输入组件id返回实体id，没有则为0</p>
<h3 id="ComponentGetMembers"><a href="#ComponentGetMembers" class="headerlink" title="ComponentGetMembers"></a><code>ComponentGetMembers</code></h3><blockquote>
<p>ComponentGetMembers( component_id:int ) -&gt; {string-string}|nil [Returns a string-indexed table of string.]</p>
</blockquote>
<p>输入组件id，返回一个字符串-索引的表，似乎包括保持默认的字段</p>
<h3 id="ComponentObjectGetMembers"><a href="#ComponentObjectGetMembers" class="headerlink" title="ComponentObjectGetMembers"></a><code>ComponentObjectGetMembers</code></h3><blockquote>
<p>ComponentObjectGetMembers( component_id:int, object_name:string ) -&gt; {string-string}|nil [Returns a string-indexed table of string or nil.]</p>
</blockquote>
<p>输入组件id和object名，返回一个字符串-索引的表</p>
<h3 id="ComponentGetTypeName"><a href="#ComponentGetTypeName" class="headerlink" title="ComponentGetTypeName"></a><code>ComponentGetTypeName</code></h3><blockquote>
<p>ComponentGetTypeName( component_id:int ) -&gt; string</p>
</blockquote>
<p>输入组件id，返回组件名（如：AnimalAIComponent）</p>
<h2 id="其它实体-组件相关"><a href="#其它实体-组件相关" class="headerlink" title="其它实体/组件相关"></a>其它实体/组件相关</h2><h3 id="GetUpdatedEntityID"><a href="#GetUpdatedEntityID" class="headerlink" title="GetUpdatedEntityID"></a><code>GetUpdatedEntityID</code></h3><blockquote>
<p>GetUpdatedEntityID() -&gt; entity_id:int</p>
</blockquote>
<p>获取更新的实体id，一个非常常用的api，用于获取一个目标</p>
<h3 id="GetUpdatedComponentID"><a href="#GetUpdatedComponentID" class="headerlink" title="GetUpdatedComponentID"></a><code>GetUpdatedComponentID</code></h3><blockquote>
<p>GetUpdatedComponentID() -&gt; component_id:int</p>
</blockquote>
<p>获取更新的组件id</p>
<h3 id="EntityInflictDamage"><a href="#EntityInflictDamage" class="headerlink" title="EntityInflictDamage"></a><code>EntityInflictDamage</code></h3><blockquote>
<p>EntityInflictDamage( entity:int, amount:number, damage_type:string, description:string, ragdoll_fx:string, impulse_x:number, impulse_y:number, entity_who_is_responsible:int = 0, world_pos_x:number = entity_x, world_pos_y:number = entity_y, knockback_force:number = 0 )</p>
</blockquote>
<p>给实体施加一个伤害，输入实体id，伤害数值（有一个系数），伤害类型，描述（随意填写），使用参考：<br><figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">EntityInflictDamage( v, <span class="number">500</span>, <span class="string">&quot;DAMAGE_CURSE&quot;</span>, <span class="string">&quot;$damage_supernova&quot;</span>, <span class="string">&quot;DISINTEGRATED&quot;</span>, <span class="number">0</span>, <span class="number">0</span>, entity_id )</span><br></pre></td></tr></table></figure><br><figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">EntityInflictDamage(controlled_entity, <span class="number">2000000</span>, <span class="string">&quot;DAMAGE_CURSE&quot;</span>, <span class="string">&quot;something&quot;</span>, <span class="string">&quot;NONE&quot;</span>, <span class="number">0</span>, <span class="number">0</span>, GameGetWorldStateEntity())</span><br></pre></td></tr></table></figure></p>
<h3 id="EntityIngestMaterial"><a href="#EntityIngestMaterial" class="headerlink" title="EntityIngestMaterial"></a><code>EntityIngestMaterial</code></h3><blockquote>
<p>EntityIngestMaterial( entity:int, material_type:number, amount:number ) [Has the same effects that would occur if ‘entity’ eats ‘amount’ number of cells of ‘material_type’ from the game world. Use this instead of directly modifying IngestionComponent values, if possible. Might not work with non-player entities. Use CellFactory_GetType() to convert a material name to material type.]</p>
</blockquote>
<p>实体摄入材料，输入实体id，材料种类（数字），数量。和实体在游戏世界里吃下amount像素的材料有同样的效果。尽可能用这个函数而不是直接修改IngestionComponent组件的字段。可能对非玩家实体不生效。用CellFactory_GetType()去把材料名转化成需要的id数字，参考：<br><figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">EntityIngestMaterial( entity_id, CellFactory_GetType(<span class="string">&quot;fungi&quot;</span>), <span class="number">200</span> )</span><br></pre></td></tr></table></figure></p>
<h3 id="EntityRemoveIngestionStatusEffect"><a href="#EntityRemoveIngestionStatusEffect" class="headerlink" title="EntityRemoveIngestionStatusEffect"></a><code>EntityRemoveIngestionStatusEffect</code></h3><blockquote>
<p>EntityRemoveIngestionStatusEffect( entity:int, status_type_id:string )</p>
</blockquote>
<p>移除实体的摄入效果，输入实体id，状态名，参考：<br><figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">EntityRemoveIngestionStatusEffect(ctx.my_player.entity, <span class="string">&quot;CHARM&quot;</span>)</span><br></pre></td></tr></table></figure></p>
<h3 id="EntityRemoveStainStatusEffect"><a href="#EntityRemoveStainStatusEffect" class="headerlink" title="EntityRemoveStainStatusEffect"></a><code>EntityRemoveStainStatusEffect</code></h3><blockquote>
<p>EntityRemoveStainStatusEffect( entity:int, status_type_id:string, status_cooldown:int = 0 )</p>
</blockquote>
<p>移除实体的沾染效果，输入实体id，状态名，冷却（默认为0），使用参考：<br><figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">EntityRemoveStainStatusEffect( player_id, <span class="string">&quot;PROTECTION_ALL&quot;</span>, <span class="number">5</span> )</span><br></pre></td></tr></table></figure></p>
<h3 id="EntityAddRandomStains"><a href="#EntityAddRandomStains" class="headerlink" title="EntityAddRandomStains"></a><code>EntityAddRandomStains</code></h3><blockquote>
<p>EntityAddRandomStains( entity:int, material_type:number, amount:number ) [Adds random visible stains of ‘material_type’ to entity. ‘amount’ controls the number of stain cells added. Does nothing if ‘entity’ doesn’t have a SpriteStainsComponent. Use CellFactory_GetType() to convert a material name to material type.]</p>
</blockquote>
<p>增加沾染脏污的贴图效果，输入实体id，材料id（CellFactory_GetType()），数量。增加随机的可见的脏污到实体上，amount控制添加的像素数，如果没有SpriteStainsComponent则什么也不会发生。</p>
<h3 id="EntitySetDamageFromMaterial"><a href="#EntitySetDamageFromMaterial" class="headerlink" title="EntitySetDamageFromMaterial"></a><code>EntitySetDamageFromMaterial</code></h3><blockquote>
<p>EntitySetDamageFromMaterial( entity:int, material_name:string, damage:number ) [Modifies DamageModelComponents materials_that_damage and materials_how_much_damage variables (and their parsed out data structures)]</p>
</blockquote>
<p>设置实体的材料伤害，输入实体id，材料名，伤害。修改DamageModelComponent中的materials_that_damage和materials_how_much_damage variables字段。<br>两个字段的定义：<br><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">std::string        materials_that_damage               acid [0, 1]         list of materials that do damage, separated by &#x27;,&#x27; e.g. &#x27;acid, fire, smoke&#x27;&quot;</span><br><span class="line">std::string        materials_how_much_damage           0.1 [0, 1]          &quot;list of damage amount per material in materials_that_damage, separated by &#x27;,&#x27;&quot;</span><br></pre></td></tr></table></figure><br>使用参考：<br><figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>( orbcount == <span class="number">12</span> ) <span class="keyword">then</span> EntitySetDamageFromMaterial( entity, <span class="string">&quot;magic_liquid_polymorph&quot;</span>, <span class="number">0.35</span>) <span class="keyword">end</span></span><br><span class="line"><span class="keyword">if</span>( orbcount == <span class="number">13</span> ) <span class="keyword">then</span> EntitySetDamageFromMaterial( entity, <span class="string">&quot;magic_liquid_random_polymorph&quot;</span>, <span class="number">0.35</span>) <span class="keyword">end</span></span><br><span class="line"><span class="keyword">if</span>( orbcount == <span class="number">14</span> ) <span class="keyword">then</span> EntitySetDamageFromMaterial( entity, <span class="string">&quot;magic_liquid_teleportation&quot;</span>, <span class="number">0.35</span>) <span class="keyword">end</span></span><br><span class="line"><span class="keyword">if</span>( orbcount == <span class="number">15</span> ) <span class="keyword">then</span> EntitySetDamageFromMaterial( entity, <span class="string">&quot;magic_liquid_movement_faster&quot;</span>, <span class="number">0.35</span>) <span class="keyword">end</span></span><br><span class="line"><span class="keyword">if</span>( orbcount == <span class="number">16</span> ) <span class="keyword">then</span> EntitySetDamageFromMaterial( entity, <span class="string">&quot;material_confusion&quot;</span>, <span class="number">0.35</span>) <span class="keyword">end</span></span><br></pre></td></tr></table></figure></p>
<h3 id="EntityRefreshSprite"><a href="#EntityRefreshSprite" class="headerlink" title="EntityRefreshSprite"></a><code>EntityRefreshSprite</code></h3><blockquote>
<p>EntityRefreshSprite( entity:int, sprite_component:int ) [Immediately refreshes the given SpriteComponent. Might be useful with text sprites if you want them to update more often than once a second.]</p>
</blockquote>
<p>立刻刷新贴图组件。如果想要文本贴图超过每秒更新一次可能会有用。输入实体id，组件id</p>
<h3 id="EntityGetWandCapacity"><a href="#EntityGetWandCapacity" class="headerlink" title="EntityGetWandCapacity"></a><code>EntityGetWandCapacity</code></h3><blockquote>
<p>EntityGetWandCapacity( entity:int ) -&gt; int [Returns the capacity of a wand entity, or 0 if ‘entity’ doesnt exist.]</p>
</blockquote>
<p>获取魔杖容量，输入魔杖的实体id，返回容量，如果不存在返回0</p>
<h3 id="EntityGetHotspot"><a href="#EntityGetHotspot" class="headerlink" title="EntityGetHotspot"></a><code>EntityGetHotspot</code></h3><blockquote>
<p>EntityGetHotspot( entity:int, hotspot_tag:string, transformed:bool, include_disabled_components:bool = false ) -&gt; x:number,y:number [Returns the position of a hot spot defined by a HotspotComponent. If ‘transformed’ is true, will return the position in world coordinates, transformed using the entity’s transform.]</p>
</blockquote>
<p>获取HotspotComponent的位置，比如手，发射点等等。输入实体id，热点标签，是否transformed，是否包含禁用的组件，返回坐标。如果transformed为true，返回在世界坐标系下的坐标<br>参考：<br><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">HotspotComponent</span></span></span><br><span class="line"><span class="tag">      <span class="attr">_tags</span>=<span class="string">&quot;hand&quot;</span></span></span><br><span class="line"><span class="tag">      <span class="attr">sprite_hotspot_name</span>=<span class="string">&quot;hand&quot;</span></span></span><br><span class="line"><span class="tag">  &gt;</span> <span class="tag">&lt;/<span class="name">HotspotComponent</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="tag">&lt;<span class="name">HotspotComponent</span></span></span><br><span class="line"><span class="tag">    <span class="attr">_tags</span>=<span class="string">&quot;shoot_pos&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">offset.x</span>=<span class="string">&quot;0&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">offset.y</span>=<span class="string">&quot;-2&quot;</span></span></span><br><span class="line"><span class="tag">  &gt;</span> <span class="tag">&lt;/<span class="name">HotspotComponent</span>&gt;</span></span><br></pre></td></tr></table></figure></p>
<h3 id="EntityGetFirstHitboxCenter"><a href="#EntityGetFirstHitboxCenter" class="headerlink" title="EntityGetFirstHitboxCenter"></a><code>EntityGetFirstHitboxCenter</code></h3><blockquote>
<p>EntityGetFirstHitboxCenter( entity_id:int ) -&gt; (x:number,y:number)|nil [Returns the centroid of first enabled HitboxComponent found in entity, the position of the entity if no hitbox is found, or nil if the entity does not exist. All returned positions are in world coordinates.]</p>
</blockquote>
<p>返回实体第一个没禁用的HitboxComponent组件的中心，没有该组件则返回实体坐标，实体不存在返回nil，均为世界坐标系下的。</p>
<h2 id="Game……"><a href="#Game……" class="headerlink" title="Game……"></a>Game……</h2><h3 id="GameScreenshake"><a href="#GameScreenshake" class="headerlink" title="GameScreenshake"></a><code>GameScreenshake</code></h3><blockquote>
<p>GameScreenshake( strength:number, x:number = camera_x, y:number = camera_y )</p>
</blockquote>
<p>摇晃屏幕，输入力度（参考值：5-150），一对坐标，默认镜头位置</p>
<h3 id="GameOnCompleted"><a href="#GameOnCompleted" class="headerlink" title="GameOnCompleted"></a><code>GameOnCompleted</code></h3><blockquote>
<p>GameOnCompleted() — this does the achievement</p>
</blockquote>
<p>用处不明，似乎只是做一个标记</p>
<h3 id="GameGiveAchievement"><a href="#GameGiveAchievement" class="headerlink" title="GameGiveAchievement"></a><code>GameGiveAchievement</code></h3><blockquote>
<p>GameGiveAchievement( id:string )</p>
</blockquote>
<p>输入成就的名称，一个字符串，给予成就。效果同上，似乎只是做个标记，不对游戏内容产生影响</p>
<h3 id="GameDoEnding2"><a href="#GameDoEnding2" class="headerlink" title="GameDoEnding2()"></a><code>GameDoEnding2()</code></h3><blockquote>
<p>GameDoEnding2()</p>
</blockquote>
<p>进入和平结局（33魔球）</p>
<h3 id="GameIsIntroPlaying"><a href="#GameIsIntroPlaying" class="headerlink" title="GameIsIntroPlaying"></a><code>GameIsIntroPlaying</code></h3><blockquote>
<p>GameIsIntroPlaying() -&gt; bool</p>
</blockquote>
<p>游戏是否在播放intro动画？大概是这个意思吧，返回一个bool值</p>
<h3 id="GameGetIsGamepadConnected"><a href="#GameGetIsGamepadConnected" class="headerlink" title="GameGetIsGamepadConnected"></a><code>GameGetIsGamepadConnected</code></h3><blockquote>
<p>GameGetIsGamepadConnected() -&gt; bool</p>
</blockquote>
<p>游戏是否连接了手柄</p>
<h3 id="GameGetWorldStateEntity"><a href="#GameGetWorldStateEntity" class="headerlink" title="GameGetWorldStateEntity"></a><code>GameGetWorldStateEntity</code></h3><blockquote>
<p>GameGetWorldStateEntity() -&gt; entity_id:int</p>
</blockquote>
<p>获取世界状态实体，返回实体id，使用参考：<br><figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">local</span> world_state_entity = GameGetWorldStateEntity()</span><br><span class="line"><span class="keyword">local</span> comp = EntityGetComponent( world_state_entity, <span class="string">&quot;WorldStateComponent&quot;</span> )</span><br></pre></td></tr></table></figure></p>
<h3 id="GameGetPlayerStatsEntity"><a href="#GameGetPlayerStatsEntity" class="headerlink" title="GameGetPlayerStatsEntity"></a><code>GameGetPlayerStatsEntity</code></h3><blockquote>
<p>GameGetPlayerStatsEntity() -&gt; entity_id:int</p>
</blockquote>
<p>获取玩家状态实体，返回一个实体id，找不到使用参考</p>
<h3 id="GameGetOrbCountAllTime"><a href="#GameGetOrbCountAllTime" class="headerlink" title="GameGetOrbCountAllTime"></a><code>GameGetOrbCountAllTime</code></h3><blockquote>
<p>GameGetOrbCountAllTime() -&gt; int</p>
</blockquote>
<p>获取所有游戏历史中获取的最多魔球数量，返回一个int数</p>
<h3 id="GameGetOrbCountThisRun"><a href="#GameGetOrbCountThisRun" class="headerlink" title="GameGetOrbCountThisRun"></a><code>GameGetOrbCountThisRun</code></h3><blockquote>
<p>GameGetOrbCountThisRun() -&gt; int</p>
</blockquote>
<p>获取本局游戏中的魔球获取数量，返回一个int数</p>
<h3 id="GameGetOrbCollectedThisRun"><a href="#GameGetOrbCollectedThisRun" class="headerlink" title="GameGetOrbCollectedThisRun"></a><code>GameGetOrbCollectedThisRun</code></h3><blockquote>
<p>GameGetOrbCollectedThisRun( orb_id_zero_based:int ) -&gt; bool</p>
</blockquote>
<p>输入一个魔球id，返回是否在本局中已收集</p>
<h3 id="GameGetOrbCollectedAllTime"><a href="#GameGetOrbCollectedAllTime" class="headerlink" title="GameGetOrbCollectedAllTime"></a><code>GameGetOrbCollectedAllTime</code></h3><blockquote>
<p>GameGetOrbCollectedAllTime( orb_id_zero_based:int ) -&gt; bool</p>
</blockquote>
<p>输入一个魔球id，返回是否在所有游戏历史中收集过</p>
<h3 id="GameClearOrbsFoundThisRun"><a href="#GameClearOrbsFoundThisRun" class="headerlink" title="GameClearOrbsFoundThisRun"></a><code>GameClearOrbsFoundThisRun</code></h3><blockquote>
<p>GameClearOrbsFoundThisRun()</p>
</blockquote>
<p>归零本局游戏的魔球获取数量，游戏中用于开启NG+</p>
<h3 id="GameGetOrbCountTotal"><a href="#GameGetOrbCountTotal" class="headerlink" title="GameGetOrbCountTotal"></a><code>GameGetOrbCountTotal</code></h3><blockquote>
<p>GameGetOrbCountTotal() -&gt; int [Returns the number of orbs, picked or not.]</p>
</blockquote>
<p>返回魔球数，包含没捡起来的</p>
<h3 id="GameRegenItemAction"><a href="#GameRegenItemAction" class="headerlink" title="GameRegenItemAction"></a><code>GameRegenItemAction</code></h3><blockquote>
<p>GameRegenItemAction( entity_id:int )</p>
</blockquote>
<p>重新生成一个物品动作，输入实体id，找不到使用参考</p>
<h3 id="GameRegenItemActionsInContainer"><a href="#GameRegenItemActionsInContainer" class="headerlink" title="GameRegenItemActionsInContainer"></a><code>GameRegenItemActionsInContainer</code></h3><blockquote>
<p>GameRegenItemActionsInContainer( entity_id:int )</p>
</blockquote>
<p>重新生成一个container里的物品动作</p>
<h3 id="GameRegenItemActionsInPlayer"><a href="#GameRegenItemActionsInPlayer" class="headerlink" title="GameRegenItemActionsInPlayer"></a><code>GameRegenItemActionsInPlayer</code></h3><blockquote>
<p>GameRegenItemActionsInPlayer( entity_id:int )</p>
</blockquote>
<p>输入实体id，使用参考：<br><figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">（无限法术天赋）</span><br><span class="line"><span class="comment">-- this goes through the items player is holding and sets their uses_remaining to -1</span></span><br><span class="line">GameRegenItemActionsInPlayer( entity_who_picked )</span><br></pre></td></tr></table></figure></p>
<h3 id="GameKillInventoryItem"><a href="#GameKillInventoryItem" class="headerlink" title="GameKillInventoryItem"></a><code>GameKillInventoryItem</code></h3><blockquote>
<p>GameKillInventoryItem( inventory_owner_entity_id:int, item_entity_id:int )</p>
</blockquote>
<p>清除一个物品栏里的物品，输入物品栏拥有者实体id，物品实体id，使用参考：<br><figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">local</span> inventory_items = EntityGetAllChildren( inventory )</span><br><span class="line">		</span><br><span class="line"><span class="comment">-- remove default items</span></span><br><span class="line"><span class="keyword">if</span> inventory_items ~= <span class="literal">nil</span> <span class="keyword">then</span></span><br><span class="line">	<span class="keyword">for</span> i,item_entity <span class="keyword">in</span> <span class="built_in">ipairs</span>( inventory_items ) <span class="keyword">do</span></span><br><span class="line">		GameKillInventoryItem( player_entity, item_entity )</span><br><span class="line">	<span class="keyword">end</span></span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure></p>
<h3 id="GamePickUpInventoryItem"><a href="#GamePickUpInventoryItem" class="headerlink" title="GamePickUpInventoryItem"></a><code>GamePickUpInventoryItem</code></h3><blockquote>
<p>GamePickUpInventoryItem( who_picks_up_entity_id:int, item_entity_id:int, do_pick_up_effects:bool = true )</p>
</blockquote>
<p>输入捡起实体的id，物品id，是否产生一个捡起的效果（默认有），使用参考：<br><figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">（给予初始杖）</span><br><span class="line"><span class="keyword">local</span> item_entity = EntityLoad( item, i * <span class="number">997</span>, i * <span class="number">853</span> )</span><br><span class="line">GamePickUpInventoryItem( player_entity, item_entity, <span class="literal">false</span> )</span><br></pre></td></tr></table></figure></p>
<h3 id="GameGetAllInventoryItems"><a href="#GameGetAllInventoryItems" class="headerlink" title="GameGetAllInventoryItems"></a><code>GameGetAllInventoryItems</code></h3><blockquote>
<p>GameGetAllInventoryItems( entity_id:int ) -&gt; {item_entity_id}|nil [Returns all the inventory items that entity_id has.]</p>
</blockquote>
<p>输入实体id，返回该实体有的所有的物品栏id（表）</p>
<h3 id="GameDropAllItems"><a href="#GameDropAllItems" class="headerlink" title="GameDropAllItems"></a><code>GameDropAllItems</code></h3><blockquote>
<p>GameDropAllItems( entity_id:int )</p>
</blockquote>
<p>输入实体id，drop所有物品，使用参考：<br><figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">local</span> entity_id = GetUpdatedEntityID()</span><br><span class="line">GameDropAllItems( entity_id )</span><br></pre></td></tr></table></figure></p>
<h3 id="GameDropPlayerInventoryItems"><a href="#GameDropPlayerInventoryItems" class="headerlink" title="GameDropPlayerInventoryItems"></a><code>GameDropPlayerInventoryItems</code></h3><blockquote>
<p>GameDropPlayerInventoryItems( entity_id:int )</p>
</blockquote>
<p>drop玩家的物品栏物品，找不到使用参考</p>
<h3 id="GameDestroyInventoryItems"><a href="#GameDestroyInventoryItems" class="headerlink" title="GameDestroyInventoryItems"></a><code>GameDestroyInventoryItems</code></h3><blockquote>
<p>GameDestroyInventoryItems( player_entity )</p>
</blockquote>
<p>销毁物品栏物品，输入实体id，使用参考：<br><figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">OnPlayerDied</span><span class="params">( player_entity )</span></span></span><br><span class="line">	GameDestroyInventoryItems( player_entity )</span><br><span class="line">	GameTriggerGameOver()</span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure></p>
<h3 id="GameIsInventoryOpen"><a href="#GameIsInventoryOpen" class="headerlink" title="GameIsInventoryOpen"></a><code>GameIsInventoryOpen</code></h3><blockquote>
<p>GameIsInventoryOpen() -&gt; bool</p>
</blockquote>
<p>是否打开了物品栏（背包），返回一个bool值</p>
<h3 id="GameTriggerGameOver"><a href="#GameTriggerGameOver" class="headerlink" title="GameTriggerGameOver"></a><code>GameTriggerGameOver</code></h3><blockquote>
<p>GameTriggerGameOver()</p>
</blockquote>
<p>结束游戏，弹出结算页面，同时镜头不跟随玩家，不负责销毁游戏实体</p>
<h3 id="GameShootProjectile"><a href="#GameShootProjectile" class="headerlink" title="GameShootProjectile"></a><code>GameShootProjectile</code></h3><blockquote>
<p>GameShootProjectile( shooter_entity:int, x:number, y:number, target_x:number, target_y:number, projectile_entity:int, send_message:bool = true, verlet_parent_entity:int = 0 ) [‘shooter_entity’ can be 0. Warning: If ‘projectile_entity’ has PhysicsBodyComponent and ItemComponent, components without the “enabled_in_world” tag will be disabled, as if the entity was thrown by player.]</p>
</blockquote>
<p>发射一个投射物，输入发射者（实体id，可以为0），起点坐标，目标点坐标，投射物实体id，后两个默认，用处未知。如果投射物实体有PhysicsBodyComponent 和 ItemComponent组件，没有“enabled_in_world”标签的组件将不可用，就好像是玩家发出的（翻译官表示没看懂）</p>
<p>使用参考：<br><figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">ui_name=<span class="string">&quot;Test GameShootProjectile bug&quot;</span>,</span><br><span class="line">		action = <span class="function"><span class="keyword">function</span><span class="params">()</span></span></span><br><span class="line">			<span class="keyword">local</span> x,y = GameGetCameraPos()</span><br><span class="line">			<span class="keyword">local</span> e = EntityLoad( <span class="string">&quot;data/entities/items/pickup/goldnugget_200.xml&quot;</span> )</span><br><span class="line">			GameShootProjectile( <span class="number">0</span>, x, y, <span class="number">0</span>, <span class="number">0</span>, e, <span class="literal">false</span> )</span><br><span class="line">		<span class="keyword">end</span></span><br></pre></td></tr></table></figure></p>
<h3 id="GameCreateSpriteForXFrames"><a href="#GameCreateSpriteForXFrames" class="headerlink" title="GameCreateSpriteForXFrames"></a><code>GameCreateSpriteForXFrames</code></h3><blockquote>
<p>GameCreateSpriteForXFrames( filename:string, x:number, y:number, centered:bool = true, sprite_offset_x:number = 0, sprite_offset_y:number = 0, frames:int = 1, emissive:bool = false )</p>
</blockquote>
<p>显示一个贴图x帧，输入贴图所在文件路径，坐标，是否居中，坐标偏移，持续帧数（默认1），是否发光，使用参考：<br><figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">GameCreateSpriteForXFrames( <span class="string">&quot;data/particles/&quot;</span> .. map_sprite .. <span class="string">&quot;.png&quot;</span>, mi_x, mi_y, <span class="literal">true</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="literal">true</span> )</span><br><span class="line">GameCreateSpriteForXFrames( <span class="string">&quot;data/particles/spatial_map_player.png&quot;</span>, pi_x, pi_y, <span class="literal">true</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="literal">true</span> )</span><br><span class="line">GameCreateSpriteForXFrames( <span class="string">&quot;data/particles/spatial_map_friend.png&quot;</span>, mi_x + fx, mi_y + fy, <span class="literal">true</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="literal">true</span> )</span><br></pre></td></tr></table></figure></p>
<h2 id="GUI"><a href="#GUI" class="headerlink" title="GUI"></a>GUI</h2><h3 id="GuiCreate"><a href="#GuiCreate" class="headerlink" title="GuiCreate"></a><code>GuiCreate</code></h3><blockquote>
<p>GuiCreate() -&gt; gui:obj</p>
</blockquote>
<p>创造一个gui，返回一个gui对象，用于进一步操作</p>
<h3 id="GuiDestroy"><a href="#GuiDestroy" class="headerlink" title="GuiDestroy"></a><code>GuiDestroy</code></h3><blockquote>
<p>GuiDestroy( gui:obj )</p>
</blockquote>
<p>销毁gui</p>
<h3 id="GuiStartFrame"><a href="#GuiStartFrame" class="headerlink" title="GuiStartFrame"></a><code>GuiStartFrame</code></h3><blockquote>
<p>GuiStartFrame( gui:obj )</p>
</blockquote>
<p>开始GUI帧，在OnWorldPreUpdate时调用，使用gui必要的函数</p>
<h3 id="GuiOptionsAdd"><a href="#GuiOptionsAdd" class="headerlink" title="GuiOptionsAdd"></a><code>GuiOptionsAdd</code></h3><blockquote>
<p>GuiOptionsAdd( gui:obj, option:int ) [Sets the options that apply to widgets during this frame. For ‘option’ use the values in the GUI_OPTION table in “data/scripts/lib/utilities.lua”. Values from consecutive calls will be combined. For example calling this with the values GUI_OPTION.Align_Left and GUI_OPTION.GamepadDefaultWidget will set both options for the next widget. The options will be cleared on next call to GuiStartFrame().]</p>
</blockquote>
<p>给gui增加“选项”，应用一个gui的所有widget，生效一帧，选项列表如下：<br><figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line">GUI_OPTION = &#123;</span><br><span class="line">	None = <span class="number">0</span>,</span><br><span class="line"></span><br><span class="line">	IsDraggable = <span class="number">1</span>, <span class="comment">-- you might not want to use this, because there will be various corner cases and bugs, but feel free to try anyway.</span></span><br><span class="line">	NonInteractive = <span class="number">2</span>, <span class="comment">-- works with GuiButton</span></span><br><span class="line">	AlwaysClickable = <span class="number">3</span>,</span><br><span class="line">	ClickCancelsDoubleClick = <span class="number">4</span>,</span><br><span class="line">	IgnoreContainer = <span class="number">5</span>,</span><br><span class="line">	NoPositionTween = <span class="number">6</span>,</span><br><span class="line">	ForceFocusable = <span class="number">7</span>,</span><br><span class="line">	HandleDoubleClickAsClick = <span class="number">8</span>,</span><br><span class="line">	GamepadDefaultWidget = <span class="number">9</span>, <span class="comment">-- it&#x27;s recommended you use this to communicate the widget where gamepad input will focus when entering a new menu</span></span><br><span class="line"></span><br><span class="line">	<span class="comment">-- these work as intended (mostly)</span></span><br><span class="line">	Layout_InsertOutsideLeft = <span class="number">10</span>,</span><br><span class="line">	Layout_InsertOutsideRight = <span class="number">11</span>,</span><br><span class="line">	Layout_InsertOutsideAbove = <span class="number">12</span>,</span><br><span class="line">	Layout_ForceCalculate = <span class="number">13</span>,</span><br><span class="line">	Layout_NextSameLine = <span class="number">14</span>,</span><br><span class="line">	Layout_NoLayouting = <span class="number">15</span>,</span><br><span class="line"></span><br><span class="line">	<span class="comment">-- these work as intended (mostly)</span></span><br><span class="line">	Align_HorizontalCenter = <span class="number">16</span>,</span><br><span class="line">	Align_Left = <span class="number">17</span>,</span><br><span class="line"></span><br><span class="line">	FocusSnapToRightEdge = <span class="number">18</span>,</span><br><span class="line"></span><br><span class="line">	NoPixelSnapY = <span class="number">19</span>,</span><br><span class="line"></span><br><span class="line">	DrawAlwaysVisible = <span class="number">20</span>,</span><br><span class="line">	DrawNoHoverAnimation = <span class="number">21</span>,</span><br><span class="line">	DrawWobble = <span class="number">22</span>,</span><br><span class="line">	DrawFadeIn = <span class="number">23</span>,</span><br><span class="line">	DrawScaleIn = <span class="number">24</span>,</span><br><span class="line">	DrawWaveAnimateOpacity = <span class="number">25</span>,</span><br><span class="line">	DrawSemiTransparent = <span class="number">26</span>,</span><br><span class="line">	DrawActiveWidgetCursorOnBothSides = <span class="number">27</span>,</span><br><span class="line">	DrawActiveWidgetCursorOff = <span class="number">28</span>,</span><br><span class="line"></span><br><span class="line">	TextRichRendering = <span class="number">29</span>,</span><br><span class="line"></span><br><span class="line">	NoSound = <span class="number">47</span>,</span><br><span class="line">	Hack_ForceClick = <span class="number">48</span>,</span><br><span class="line">	Hack_AllowDuplicateIds = <span class="number">49</span>,</span><br><span class="line"></span><br><span class="line">	ScrollContainer_Smooth = <span class="number">50</span>,</span><br><span class="line">	IsExtraDraggable = <span class="number">51</span>,</span><br><span class="line"></span><br><span class="line">	_SnapToCenter = <span class="number">62</span>,</span><br><span class="line">	Disabled = <span class="number">63</span>,</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<h3 id="GuiOptionsAddForNextWidget"><a href="#GuiOptionsAddForNextWidget" class="headerlink" title="GuiOptionsAddForNextWidget"></a><code>GuiOptionsAddForNextWidget</code></h3><blockquote>
<p>GuiOptionsAddForNextWidget( gui:obj, option:int ) [Sets the options that apply to the next widget during this frame. For ‘option’ use the values in the GUI_OPTION table in “data/scripts/lib/utilities.lua”. Values from consecutive calls will be combined. For example calling this with the values GUI_OPTION.Align_Left and GUI_OPTION.GamepadDefaultWidget will set both options for the next widget.</p>
</blockquote>
<p>为下一个widget设置“选项”，参数同上，使用参考：<br><figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">GuiOptionsAddForNextWidget( gui, GUI_OPTION.DrawActiveWidgetCursorOff )</span><br><span class="line">GuiOptionsAddForNextWidget( gui, GUI_OPTION.NoPositionTween )</span><br></pre></td></tr></table></figure></p>
<h3 id="GuiOptionsRemove"><a href="#GuiOptionsRemove" class="headerlink" title="GuiOptionsRemove"></a><code>GuiOptionsRemove</code></h3><blockquote>
<p>GuiOptionsRemove( gui:obj, option:int ) [Sets the options that apply to widgets during this frame. For ‘option’ use the values in the GUI_OPTION table in “data/scripts/lib/utilities.lua”. Values from consecutive calls will be combined. For example calling this with the values GUI_OPTION.Align_Left and GUI_OPTION.GamepadDefaultWidget will set both options for the next widget. The options will be cleared on next call to GuiStartFrame().]</p>
</blockquote>
<p>移除特定选项，参数同上，真有用吗？</p>
<h3 id="GuiOptionsClear"><a href="#GuiOptionsClear" class="headerlink" title="GuiOptionsClear"></a><code>GuiOptionsClear</code></h3><blockquote>
<p>GuiOptionsClear( gui:obj ) [Clears the options that apply to widgets during this frame.]</p>
</blockquote>
<p>清除gui的所有“选项”，输入gui，同上，真有用吗？</p>
<h3 id="GuiZSet"><a href="#GuiZSet" class="headerlink" title="GuiZSet"></a><code>GuiZSet</code></h3><blockquote>
<p>GuiZSet( gui:obj, z:float ) [Sets the rendering depth (‘z’) of the widgets following this call. Larger z = deeper. The z will be set to 0 on the next call to GuiStartFrame(). ]</p>
</blockquote>
<p>设置gui的深度（覆盖关系，值越大越深，即在下层），输入gui、z值，在下一次GuiStartFrame()时会被清零</p>
<h3 id="GuiZSetForNextWidget"><a href="#GuiZSetForNextWidget" class="headerlink" title="GuiZSetForNextWidget"></a><code>GuiZSetForNextWidget</code></h3><blockquote>
<p>GuiZSetForNextWidget( gui:obj, z:float ) [Sets the rendering depth (‘z’) of the next widget following this call. Larger z = deeper.</p>
</blockquote>
<p>设置下一个widget的渲染深度，用法同上</p>
<h3 id="GuiText"><a href="#GuiText" class="headerlink" title="GuiText"></a><code>GuiText</code></h3><blockquote>
<p>GuiText( gui:obj, x:number, y:number, text:string, scale:number = 1, font:string = “”, font_is_pixel_font:bool = true )</p>
</blockquote>
<p>显示文字，输入gui、在屏幕上的位置、文本内容、放大倍数、字体、字体是否是像素。后三个保持默认即可</p>
<h3 id="GuiIdPush"><a href="#GuiIdPush" class="headerlink" title="GuiIdPush"></a><code>GuiIdPush</code></h3><blockquote>
<p>GuiIdPush( gui:obj, id:int ) [Can be used to solve ID conflicts. All ids given to Gui* functions will be hashed with the ids stacked (and hashed together) using GuiIdPush() and GuiIdPop(). The id stack has a max size of 1024, and calls to the function will do nothing if the size is exceeded.]</p>
</blockquote>
<p>输入gui，id，用于解决ID（后续创建各种widget需要）冲突</p>
<h3 id="GuiIdPushString"><a href="#GuiIdPushString" class="headerlink" title="GuiIdPushString"></a><code>GuiIdPushString</code></h3><blockquote>
<p>GuiIdPushString( gui:obj, str:string ) [Pushes the hash of ‘str’ as a gui id. See GuiIdPush().]</p>
</blockquote>
<h3 id="GuiIdPop"><a href="#GuiIdPop" class="headerlink" title="GuiIdPop"></a><code>GuiIdPop</code></h3><blockquote>
<p>GuiIdPop( gui:obj ) [See GuiIdPush().]</p>
</blockquote>
<h3 id="GuiButton"><a href="#GuiButton" class="headerlink" title="GuiButton"></a><code>GuiButton</code></h3><blockquote>
<p>GuiButton( gui:obj, id:int, x:number, y:number, text:string, scale:number = 1, font:string = “”, font_is_pixel_font:bool = true ) -&gt; clicked:bool,right_clicked:bool [The old parameter order where ‘id’ is the last parameter is still supported. The function dynamically picks the correct order based on the type of the 4th parameter.]</p>
</blockquote>
<p>显示一个文字按钮，输入gui、一个自己管理的id、在屏幕上的位置，字符串、放大倍数……返回两个bool值：是否点击，是否是右键点击</p>
<h3 id="GuiImageButton"><a href="#GuiImageButton" class="headerlink" title="GuiImageButton"></a><code>GuiImageButton</code></h3><blockquote>
<p>GuiImageButton( gui:obj, id:int, x:number, y:number, text:string, sprite_filename:string ) -&gt; clicked:bool,right_clicked:bool</p>
</blockquote>
<p>显示一个图片按钮，输入gui、id、位置、文本、图片文件路径</p>
<h3 id="GuiImage"><a href="#GuiImage" class="headerlink" title="GuiImage"></a><code>GuiImage</code></h3><blockquote>
<p><code>GuiImage(gui, x, y, filename, alpha, scale, rotation)</code> - 显示图像</p>
</blockquote>
<h3 id="GuiImageNinePiece"><a href="#GuiImageNinePiece" class="headerlink" title="GuiImageNinePiece"></a><code>GuiImageNinePiece</code></h3><blockquote>
<p>GuiImageNinePiece( gui:obj, id:int, x:number, y:number, width:number, height:number, alpha:number = 1, sprite_filename:string = “data/ui_gfx/decorations/9piece0_gray.png”, sprite_highlight_filename:string = “data/ui_gfx/decorations/9piece0_gray.png” )</p>
</blockquote>
<p>输入gui，一个不重复的id，屏幕位置，宽、高，透明度、纹理文件</p>
<h3 id="GuiTextInput"><a href="#GuiTextInput" class="headerlink" title="GuiTextInput"></a><code>GuiTextInput</code></h3><blockquote>
<p>GuiTextInput( gui:obj, id:int, x:number, y:number, text:string, width:number, max_length:int, allowed_characters:string = “” ) -&gt; new_text [‘allowed_characters’ should consist only of ASCII characters. This is not intended to be outside mod settings menu, and might bug elsewhere.]</p>
</blockquote>
<p>文本输入框，输入gui、id、位置、在框里显示的文本、宽度、最大长度，返回文本</p>
<h3 id="GuiGetScreenDimensions"><a href="#GuiGetScreenDimensions" class="headerlink" title="GuiGetScreenDimensions"></a><code>GuiGetScreenDimensions</code></h3><blockquote>
<p>GuiGetScreenDimensions( gui:obj ) -&gt; width:number,height:number [Returns dimensions of viewport in the gui coordinate system (which is equal to the coordinates of the screen bottom right corner in gui coordinates). The values returned may change depending on the game resolution because the UI is scaled for pixel-perfect text rendering.]</p>
</blockquote>
<p>输入gui，返回屏幕的宽和高（像素），使用参考：<br><figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">local</span> screen_w, screen_h = GuiGetScreenDimensions(gui)</span><br></pre></td></tr></table></figure></p>
<h3 id="GuiGetPreviousWidgetInfo"><a href="#GuiGetPreviousWidgetInfo" class="headerlink" title="GuiGetPreviousWidgetInfo"></a><code>GuiGetPreviousWidgetInfo</code></h3><blockquote>
<p>GuiGetPreviousWidgetInfo( gui:obj ) -&gt; clicked:bool, right_clicked:bool, hovered:bool, x:number, y:number, width:number, height:number, draw_x:number, draw_y:number, draw_width:number, draw_height:number [Returns the final position, size etc calculated for a widget. Some values aren’t supported by all widgets.]</p>
</blockquote>
<p>感知一个ui的状态，点击/悬浮等等，输入gui，返回：是否被点击，是否右键点击，是否鼠标悬浮在上面，gui的坐标、宽高、渲染出来的位置、渲染出来的宽、高（部分返回值不适用于所有gui）</p>
<h3 id="GuiColorSetForNextWidget"><a href="#GuiColorSetForNextWidget" class="headerlink" title="GuiColorSetForNextWidget"></a><code>GuiColorSetForNextWidget</code></h3><blockquote>
<p>GuiColorSetForNextWidget( gui:obj, red:number, green:number, blue:number, alpha:number ) [Sets the color of the next widget during this frame. Color components should be in the 0-1 range.]</p>
</blockquote>
<p>设置下一个widget的颜色，输入gui，红绿蓝值（0-1）和透明度</p>
<h2 id="粒子"><a href="#粒子" class="headerlink" title="粒子"></a>粒子</h2><h3 id="GameCreateCosmeticParticle"><a href="#GameCreateCosmeticParticle" class="headerlink" title="GameCreateCosmeticParticle"></a><code>GameCreateCosmeticParticle</code></h3><blockquote>
<p>GameCreateCosmeticParticle( material_name:string, x:number, y:number, how_many:int, xvel:number, yvel:number, color:uint32 = 0, lifetime_min:number = 5.0, lifetime_max:number = 10, force_create:bool = true, draw_front:bool = false, collide_with_grid:bool = true, randomize_velocity:bool = true, gravity_x:float = 0, gravity_y:float = 100.0 )</p>
</blockquote>
<figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">GameCreateCosmeticParticle(</span><br><span class="line">          material,       <span class="comment">-- 材质名</span></span><br><span class="line">          xi, yi,         <span class="comment">-- 坐标</span></span><br><span class="line">          how_many_per_point, <span class="comment">-- 每个点生成粒子数</span></span><br><span class="line">          <span class="number">0</span>, <span class="number">0</span>,           <span class="comment">-- xvel, yvel初速度</span></span><br><span class="line">          <span class="number">0</span>,              <span class="comment">-- color (0表示默认)</span></span><br><span class="line">          <span class="number">0</span>, <span class="number">0</span>,          <span class="comment">-- lifetime_min, lifetime_max</span></span><br><span class="line">          <span class="literal">true</span>,           <span class="comment">-- force_create</span></span><br><span class="line">          <span class="literal">false</span>,          <span class="comment">-- draw_front</span></span><br><span class="line">          <span class="literal">false</span>,          <span class="comment">-- collide_with_grid 不碰撞</span></span><br><span class="line">          <span class="literal">true</span>,          <span class="comment">-- randomize_velocity false 固定位置</span></span><br><span class="line">          <span class="number">0</span>, <span class="number">0</span>            <span class="comment">-- gravity_x, gravity_y =0 不受重力</span></span><br><span class="line">)</span><br></pre></td></tr></table></figure>
<p>大部分材料都可以填进material里，比如spark</p>
<h3 id="GameCreateParticle"><a href="#GameCreateParticle" class="headerlink" title="GameCreateParticle"></a><code>GameCreateParticle</code></h3><blockquote>
<p>GameCreateParticle( material_name:string, x:number, y:number, how_many:int, xvel:number, yvel:number, just_visual:bool, draw_as_long:bool = false, randomize_velocity:bool = true )</p>
</blockquote>
<p>生成粒子，输入材料名，坐标，数量，xy轴初速度，是否只用于视觉效果，是否画成长条形，是否随机化初速度，使用参考：<br><figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">GameCreateParticle( <span class="string">&quot;slime_green&quot;</span>, x+<span class="number">20</span>, y, <span class="number">250</span>, <span class="number">0</span>, <span class="number">-20</span>, <span class="literal">true</span>, <span class="literal">false</span> )</span><br></pre></td></tr></table></figure></p>
<h2 id="Input……"><a href="#Input……" class="headerlink" title="Input……"></a>Input……</h2><h3 id="InputIsKeyDown"><a href="#InputIsKeyDown" class="headerlink" title="InputIsKeyDown"></a><code>InputIsKeyDown</code></h3><blockquote>
<p>InputIsKeyDown( key_code\:int ) -&gt; bool<br>(Debugish function - returns if a key is down, does not depend on state. E.g. player could be in menus or inputting text. See <code>data/scripts/debug/keycodes.lua</code> for the constants.)</p>
</blockquote>
<p>检测某个键是否正在被按下。即使玩家在菜单界面或输入文字时，也会返回真实的按键状态。<code>key_code</code> 常量可在 <code>data/scripts/debug/keycodes.lua</code> 中查找。</p>
<h3 id="InputIsKeyJustDown"><a href="#InputIsKeyJustDown" class="headerlink" title="InputIsKeyJustDown"></a><code>InputIsKeyJustDown</code></h3><blockquote>
<p>InputIsKeyJustDown( key_code\:int ) -&gt; bool<br>(Debugish function - returns if a key is down this frame, does not depend on state.)</p>
</blockquote>
<p>检测某个键是否在本帧刚刚被按下（按键触发瞬间）。<br>不受游戏状态影响，在菜单或文字输入中也会检测到。</p>
<h3 id="InputIsKeyJustUp"><a href="#InputIsKeyJustUp" class="headerlink" title="InputIsKeyJustUp"></a><code>InputIsKeyJustUp</code></h3><blockquote>
<p>InputIsKeyJustUp( key_code\:int ) -&gt; bool<br>(Debugish function - returns if a key is up this frame, does not depend on state.)</p>
</blockquote>
<p>检测某个键是否在本帧刚刚被释放。同样独立于游戏状态。</p>
<h3 id="InputGetMousePosOnScreen"><a href="#InputGetMousePosOnScreen" class="headerlink" title="InputGetMousePosOnScreen"></a><code>InputGetMousePosOnScreen</code></h3><blockquote>
<p>InputGetMousePosOnScreen() -&gt; x\:number, y\:number<br>(Debugish function - returns raw x, y coordinates of the mouse on screen)</p>
</blockquote>
<p>获取鼠标在屏幕上的原始坐标（像素单位）。</p>
<h3 id="InputIsMouseButtonDown"><a href="#InputIsMouseButtonDown" class="headerlink" title="InputIsMouseButtonDown"></a><code>InputIsMouseButtonDown</code></h3><blockquote>
<p>InputIsMouseButtonDown( mouse_button\:int ) -&gt; bool<br>(Debugish function - returns if mouse button is down. Does not depend on state.)</p>
</blockquote>
<p>检测鼠标某个按键是否处于按下状态。<br><code>mouse_button</code> 常量可在 <code>data/scripts/debug/keycodes.lua</code> 查找。</p>
<h3 id="InputIsMouseButtonJustDown"><a href="#InputIsMouseButtonJustDown" class="headerlink" title="InputIsMouseButtonJustDown"></a><code>InputIsMouseButtonJustDown</code></h3><blockquote>
<p>InputIsMouseButtonJustDown( mouse_button\:int ) -&gt; bool<br>(Debugish function - returns if mouse button is just down. Does not depend on state.)</p>
</blockquote>
<p>检测鼠标按键是否在本帧刚刚被按下。</p>
<h3 id="InputIsMouseButtonJustUp"><a href="#InputIsMouseButtonJustUp" class="headerlink" title="InputIsMouseButtonJustUp"></a><code>InputIsMouseButtonJustUp</code></h3><blockquote>
<p>InputIsMouseButtonJustUp( mouse_button\:int ) -&gt; bool<br>(Debugish function - returns if mouse button is just up. Does not depend on state.)</p>
</blockquote>
<p>检测鼠标按键是否在本帧刚刚被释放。</p>
<h3 id="InputIsJoystickButtonDown"><a href="#InputIsJoystickButtonDown" class="headerlink" title="InputIsJoystickButtonDown"></a><code>InputIsJoystickButtonDown</code></h3><blockquote>
<p>InputIsJoystickButtonDown( joystick_index\:int, joystick_button\:int ) -&gt; bool<br>(Debugish function - returns if ‘joystick’ button is down. Does not depend on state.)</p>
</blockquote>
<p>检测手柄指定按钮是否处于按下状态。<br><code>joystick_index</code> 表示手柄编号（从 0 开始），<code>joystick_button</code> 常量见 <code>keycodes.lua</code>。</p>
<h3 id="InputIsJoystickButtonJustDown"><a href="#InputIsJoystickButtonJustDown" class="headerlink" title="InputIsJoystickButtonJustDown"></a><code>InputIsJoystickButtonJustDown</code></h3><blockquote>
<p>InputIsJoystickButtonJustDown( joystick_index\:int, joystick_button\:int ) -&gt; bool<br>(Debugish function - returns if ‘joystick’ button is just down. Does not depend on state.)</p>
</blockquote>
<p>检测手柄按钮是否在本帧刚刚被按下。</p>
<h3 id="InputGetJoystickAnalogButton"><a href="#InputGetJoystickAnalogButton" class="headerlink" title="InputGetJoystickAnalogButton"></a><code>InputGetJoystickAnalogButton</code></h3><blockquote>
<p>InputGetJoystickAnalogButton( joystick_index\:int, analog_button_index\:int ) -&gt; float<br>(Debugish function - returns analog ‘joystick’ button value (0-1). analog_button_index 0 = left trigger, 1 = right trigger.)</p>
</blockquote>
<p>获取手柄的模拟按键（通常是扳机键）当前的压力值，范围 0~1。<br><code>analog_button_index</code>：</p>
<ul>
<li><code>0</code> = 左扳机</li>
<li><code>1</code> = 右扳机</li>
</ul>
<h3 id="InputIsJoystickConnected"><a href="#InputIsJoystickConnected" class="headerlink" title="InputIsJoystickConnected"></a><code>InputIsJoystickConnected</code></h3><blockquote>
<p>InputIsJoystickConnected( joystick_index\:int ) -&gt; bool<br>(Debugish function - returns true if ‘joystick’ at that index is connected. Does not depend on state.)</p>
</blockquote>
<p>检测指定编号的手柄是否已连接。</p>
<h3 id="InputGetJoystickAnalogStick"><a href="#InputGetJoystickAnalogStick" class="headerlink" title="InputGetJoystickAnalogStick"></a><code>InputGetJoystickAnalogStick</code></h3><blockquote>
<p>InputGetJoystickAnalogStick( joystick_index\:int, stick_id\:int = 0 ) -&gt; float x, float y<br>(Debugish function - returns analog stick positions (-1,+1). stick_id 0 = left, 1 = right.)</p>
</blockquote>
<p>获取手柄摇杆的当前位置（X、Y 坐标范围 -1~+1）。<br><code>stick_id</code>：</p>
<ul>
<li><code>0</code> = 左摇杆</li>
<li><code>1</code> = 右摇杆</li>
</ul>
<h2 id="Biome……（群系）"><a href="#Biome……（群系）" class="headerlink" title="Biome……（群系）"></a>Biome……（群系）</h2><p>备注：群系生效的最小单位是区块，以下坐标如果有忘记说明均做区块处理</p>
<h3 id="BiomeMapLoad-KeepPlayer"><a href="#BiomeMapLoad-KeepPlayer" class="headerlink" title="BiomeMapLoad_KeepPlayer"></a><code>BiomeMapLoad_KeepPlayer</code></h3><blockquote>
<p>BiomeMapLoad_KeepPlayer( filename:string, pixel_scenes:string = “data/biome/_pixel_scenes.xml” )</p>
</blockquote>
<p>保留玩家加载群系地图，输入一个群系lua文件路径，一个像素场景xml文件<br><figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">--ng+</span></span><br><span class="line">BiomeMapLoad_KeepPlayer( <span class="string">&quot;data/biome_impl/biome_map_newgame_plus.lua&quot;</span>, <span class="string">&quot;data/biome/_pixel_scenes_newgame_plus.xml&quot;</span> )</span><br></pre></td></tr></table></figure></p>
<h3 id="BiomeSetValue"><a href="#BiomeSetValue" class="headerlink" title="BiomeSetValue"></a><code>BiomeSetValue</code></h3><blockquote>
<p>BiomeSetValue( filename:string, field_name:string, value:multiple_types ) [Can be used to edit biome configs during initialization. See the nightmare mod for an usage example.]</p>
</blockquote>
<p>只能用在OnWorldInitialized阶段，修改群系xml文件的一个字段的值，输入文件路径，字段名，值。使用参考：<br><figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">set_biome_to_nightmare</span><span class="params">( biome_name, hp_scale, attack_speed )</span></span></span><br><span class="line">	<span class="keyword">local</span> biome_filename = <span class="string">&quot;data/biome/&quot;</span> .. biome_name .. <span class="string">&quot;.xml&quot;</span></span><br><span class="line">	BiomeSetValue( biome_filename, <span class="string">&quot;game_enemy_hp_scale&quot;</span>, hp_scale )</span><br><span class="line">	BiomeSetValue( biome_filename, <span class="string">&quot;game_enemy_attack_speed&quot;</span>, attack_speed )</span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure></p>
<h3 id="BiomeGetValue"><a href="#BiomeGetValue" class="headerlink" title="BiomeGetValue"></a><code>BiomeGetValue</code></h3><blockquote>
<p>BiomeGetValue( filename:string, field_name:string ) -&gt; multiple types|nil [Can be used to read biome configs. Returns one or many values matching the type or subtypes of the requested field. Reports error and returns nil if the field type is not supported or field was not found.]</p>
</blockquote>
<p>读一个群系xml文件字段的值，输入路径，字段名，字段匹配不到报错或返回nil</p>
<h3 id="BiomeObjectSetValue"><a href="#BiomeObjectSetValue" class="headerlink" title="BiomeObjectSetValue"></a><code>BiomeObjectSetValue</code></h3><blockquote>
<p>BiomeObjectSetValue( filename:string, meta_object_name:string, field_name:string, value:multiple_types ) [Can be used to edit biome configs during initialization. See biome_modifiers.lua for an usage example.]</p>
</blockquote>
<p>仅世界初始化时可用，修改xml文件里嵌套的“对象”的字段值，输入文件路径，对象名，字段名，值，举例：<br><figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- projectiles and most entities get higher gravity (doesn&#x27;t affect physics or particles)</span></span><br><span class="line">&#123;</span><br><span class="line">	id = <span class="string">&quot;HIGH_GRAVITY&quot;</span>,</span><br><span class="line">	ui_description=<span class="string">&quot;$biomemodifierdesc_high_gravity&quot;</span>,</span><br><span class="line">	ui_decoration_file=<span class="string">&quot;data/ui_gfx/decorations_biome_modifier/high_gravity.png&quot;</span>,</span><br><span class="line">	probability=<span class="number">0.5</span>,</span><br><span class="line">	action = <span class="function"><span class="keyword">function</span><span class="params">( biome_name, biome_filename )</span></span></span><br><span class="line">		BiomeObjectSetValue( biome_filename, <span class="string">&quot;modifiers&quot;</span>, <span class="string">&quot;entity_gravity_y_multiplier&quot;</span>, <span class="number">1.5</span> )</span><br><span class="line">	<span class="keyword">end</span>,</span><br><span class="line">&#125;,</span><br></pre></td></tr></table></figure><br>其中modifier是一个隐式对象，以上是随机事件之一</p>
<h3 id="BiomeVegetationSetValue"><a href="#BiomeVegetationSetValue" class="headerlink" title="BiomeVegetationSetValue"></a><code>BiomeVegetationSetValue</code></h3><blockquote>
<p>BiomeVegetationSetValue( filename:string, material_name:string, field_name:string, value:multiple_types ) [Can be used to edit biome config MaterialComponents during initialization. Sets the given value in all found VegetationComponent with matching tree_material. See biome_modifiers.lua for an usage example.]</p>
</blockquote>
<p>仅世界初始化时可用，设置群系植物的属性，即所有VegetationComponent中匹配的字段，输入文件路径，材料名，字段名，值，参考：<br><figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">BiomeVegetationSetValue( biome_filename, <span class="string">&quot;grass&quot;</span>, <span class="string">&quot;tree_material&quot;</span>, frozen_veg_type )</span><br></pre></td></tr></table></figure></p>
<h3 id="BiomeMaterialSetValue"><a href="#BiomeMaterialSetValue" class="headerlink" title="BiomeMaterialSetValue"></a><code>BiomeMaterialSetValue</code></h3><blockquote>
<p>BiomeMaterialSetValue( filename:string, material_name:string, field_name:string, value:multiple_types ) [Can be used to edit biome config MaterialComponents during initialization. Sets the given value in the first found MaterialComponent with matching material_name. See biome_modifiers.lua for an usage example.]</p>
</blockquote>
<p>仅世界初始化时可用，设置群系材料属性，第一个找到的有匹配字段的MaterialComponent，参数同上，使用参考：<br><figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">--在地面中生成更多黄金的事件</span></span><br><span class="line">action = <span class="function"><span class="keyword">function</span><span class="params">( biome_name, biome_filename )</span></span></span><br><span class="line">			<span class="keyword">if</span> biome_name == <span class="string">&quot;rainforest&quot;</span> <span class="keyword">or</span> biome_name == <span class="string">&quot;rainforest_open&quot;</span> <span class="keyword">or</span> biome_name == <span class="string">&quot;vault&quot;</span> <span class="keyword">or</span> biome_name == <span class="string">&quot;fungicave&quot;</span> <span class="keyword">then</span></span><br><span class="line">				BiomeMaterialSetValue( biome_filename, <span class="string">&quot;gold&quot;</span>, <span class="string">&quot;material_max&quot;</span>, <span class="number">1.0</span> ) </span><br><span class="line">				BiomeMaterialSetValue( biome_filename, <span class="string">&quot;gold&quot;</span>, <span class="string">&quot;material_min&quot;</span>, <span class="number">0.9</span> )</span><br><span class="line">			<span class="keyword">elseif</span> biome_name == <span class="string">&quot;crypt&quot;</span> <span class="keyword">then</span></span><br><span class="line">				BiomeMaterialSetValue( biome_filename, <span class="string">&quot;gold&quot;</span>, <span class="string">&quot;material_max&quot;</span>, <span class="number">20</span> ) </span><br><span class="line">				BiomeMaterialSetValue( biome_filename, <span class="string">&quot;gold&quot;</span>, <span class="string">&quot;material_min&quot;</span>, <span class="number">0.05</span> )</span><br><span class="line">			<span class="keyword">else</span></span><br><span class="line">				BiomeMaterialSetValue( biome_filename, <span class="string">&quot;gold&quot;</span>, <span class="string">&quot;material_max&quot;</span>, <span class="number">10</span> ) </span><br><span class="line">				BiomeMaterialSetValue( biome_filename, <span class="string">&quot;gold&quot;</span>, <span class="string">&quot;material_min&quot;</span>, <span class="number">0.1</span> )</span><br><span class="line">			<span class="keyword">end</span></span><br><span class="line">		<span class="keyword">end</span>,</span><br></pre></td></tr></table></figure></p>
<h3 id="BiomeMaterialGetValue"><a href="#BiomeMaterialGetValue" class="headerlink" title="BiomeMaterialGetValue"></a><code>BiomeMaterialGetValue</code></h3><blockquote>
<p>BiomeMaterialGetValue( filename:string, material_name:string, field_name:string ) -&gt; multiple types|nil [Can be used to read biome config MaterialComponents during initialization. Returns the given value in the first found MaterialComponent with matching material_name. See biome_modifiers.lua for an usage example.]</p>
</blockquote>
<p>仅世界初始化时可用，获取群系材料的字段的值，输入文件路径，材料名，字段，寻找第一个匹配的MaterialComponent组件</p>
<div class="note danger flat"><p>以下群系api均需要BIOME_MAP在magic_numbers.xml里指向一个lua文件，默认是<code>BIOME_MAP=&quot;data/scripts/biome_map.lua&quot;</code></p>
</div>
<h3 id="BiomeMapSetSize"><a href="#BiomeMapSetSize" class="headerlink" title="BiomeMapSetSize"></a><code>BiomeMapSetSize</code></h3><blockquote>
<p>BiomeMapSetSize( width:int, height:int ) [This is available if BIOME_MAP in magic_numbers.xml points to a lua file, in the context of that file.]</p>
</blockquote>
<p>设置群系地图的尺寸，单位是区块。<br><figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">--data/scripts/biome_map.lua</span></span><br><span class="line"><span class="comment">-- 2024/2/2 - made biome map loading work through this file to make it easier for mods to modify it</span></span><br><span class="line">dofile_once(<span class="string">&quot;data/scripts/lib/utilities.lua&quot;</span>)</span><br><span class="line">BiomeMapSetSize( <span class="number">70</span>, <span class="number">48</span> )</span><br><span class="line">BiomeMapLoadImage( <span class="number">0</span>, <span class="number">0</span>, <span class="string">&quot;data/biome_impl/biome_map.png&quot;</span> )</span><br></pre></td></tr></table></figure></p>
<h3 id="BiomeMapGetSize"><a href="#BiomeMapGetSize" class="headerlink" title="BiomeMapGetSize"></a><code>BiomeMapGetSize</code></h3><blockquote>
<p>BiomeMapGetSize() -&gt; width:int,height:int [if BIOME_MAP in magic_numbers.xml points to a lua file returns that context, if not will return the biome_map size]</p>
</blockquote>
<p>返回尺寸（区块）</p>
<h3 id="BiomeMapSetPixel"><a href="#BiomeMapSetPixel" class="headerlink" title="BiomeMapSetPixel"></a><code>BiomeMapSetPixel</code></h3><blockquote>
<p>BiomeMapSetPixel( x:int, y:int, color_int:int ) [This is available if BIOME_MAP in magic_numbers.xml points to a lua file, in the context of that file.]</p>
</blockquote>
<p>设置生物群系像素，输入坐标（区块），“颜色”。其中颜色对应着一个xml文件，在_biomes_all.xml里写明，为一种地形的代号</p>
<h3 id="BiomeMapGetPixel"><a href="#BiomeMapGetPixel" class="headerlink" title="BiomeMapGetPixel"></a><code>BiomeMapGetPixel</code></h3><blockquote>
<p>BiomeMapGetPixel( x:int, y:int ) -&gt; color:int [This is available if BIOME_MAP in magic_numbers.xml points to a lua file, in the context of that file.]</p>
</blockquote>
<p>获取群系颜色，输入坐标，返回颜色。</p>
<h3 id="BiomeMapConvertPixelFromUintToInt"><a href="#BiomeMapConvertPixelFromUintToInt" class="headerlink" title="BiomeMapConvertPixelFromUintToInt"></a><code>BiomeMapConvertPixelFromUintToInt</code></h3><blockquote>
<p>BiomeMapConvertPixelFromUintToInt( color:int ) -&gt; int [Swaps red and blue channels of ‘color’. This can be used make sense of the BiomeMapGetPixel() return values. E.g. if( BiomeMapGetPixel( x, y ) == BiomeMapConvertPixelFromUintToInt( 0xFF36D517 ) ) then print(‘hills’) end ]</p>
</blockquote>
<p>将无符号整数颜色值转换为有符号整数颜色值。主要是交换红色和蓝色通道。用于颜色数值的比较<br><figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>( BiomeMapGetPixel( x, y ) == BiomeMapConvertPixelFromUintToInt( <span class="number">0xFF36D517</span> ) ) <span class="keyword">then</span> </span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;hills&#x27;</span>) </span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure></p>
<h3 id="BiomeMapLoadImage"><a href="#BiomeMapLoadImage" class="headerlink" title="BiomeMapLoadImage"></a><code>BiomeMapLoadImage</code></h3><blockquote>
<p>BiomeMapLoadImage( x:int, y:int, image_filename:string ) [This is available if BIOME_MAP in magic_numbers.xml points to a lua file, in the context of that file.]</p>
</blockquote>
<p>加载的是地图群系数据，不同颜色标注着不同的群系的图。输入原点坐标，颜色图片文件</p>
<h3 id="BiomeMapLoadImageCropped"><a href="#BiomeMapLoadImageCropped" class="headerlink" title="BiomeMapLoadImageCropped"></a><code>BiomeMapLoadImageCropped</code></h3><blockquote>
<p>BiomeMapLoadImageCropped( x:int, y:int, image_filename:string, image_x:int, image_y:int, image_w:int, image_h:int ) [This is available if BIOME_MAP in magic_numbers.xml points to a lua file, in the context of that file.]</p>
</blockquote>
<p>将指定的裁剪图像加载到生物群系地图中的特定位置，输入图片要放到的坐标，图片文件，裁剪范围</p>
<h3 id="BiomeMapGetVerticalPositionInsideBiome"><a href="#BiomeMapGetVerticalPositionInsideBiome" class="headerlink" title="BiomeMapGetVerticalPositionInsideBiome"></a><code>BiomeMapGetVerticalPositionInsideBiome</code></h3><blockquote>
<p>BiomeMapGetVerticalPositionInsideBiome( x:number, y:number ) -&gt; number</p>
</blockquote>
<p>获取在一个群系里的深度，输入世界坐标，返回一个数值。使用参考：<br><figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">spawn_small_enemies</span><span class="params">(x, y)</span></span></span><br><span class="line">	<span class="keyword">local</span> r = ProceduralRandom( x, y )</span><br><span class="line">	<span class="keyword">local</span> spawn_percent = BiomeMapGetVerticalPositionInsideBiome( x, y )</span><br><span class="line">	spawn_percent = ( <span class="number">2.5</span> * spawn_percent ) + <span class="number">0.35</span></span><br><span class="line">	<span class="keyword">if</span>( r &gt; spawn_percent ) <span class="keyword">then</span> <span class="keyword">return</span> <span class="keyword">end</span></span><br><span class="line"></span><br><span class="line">	spawn(g_small_enemies,x,y)</span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure></p>
<h3 id="BiomeMapGetName"><a href="#BiomeMapGetName" class="headerlink" title="BiomeMapGetName"></a><code>BiomeMapGetName</code></h3><blockquote>
<p>BiomeMapGetName( x:number = camera_x, y:number = camera_y ) -&gt; name</p>
</blockquote>
<p>获取群系名字，输入世界坐标系下的坐标（像素），默认为镜头位置，返回名字。参考：<br><figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">local</span> pos_x, pos_y = EntityGetTransform( entity_id )</span><br><span class="line"><span class="keyword">local</span> biome = BiomeMapGetName( pos_x, pos_y )</span><br></pre></td></tr></table></figure></p>
<h2 id="CellFactory……（像素）"><a href="#CellFactory……（像素）" class="headerlink" title="CellFactory……（像素）"></a>CellFactory……（像素）</h2><h3 id="CellFactory-GetName"><a href="#CellFactory-GetName" class="headerlink" title="CellFactory_GetName"></a><code>CellFactory_GetName</code></h3><blockquote>
<p>CellFactory_GetName( material_id:int ) -&gt; string [Converts a numeric material id to the material’s strings id.]</p>
</blockquote>
<p>输入材料id，返回材料名（字符串）</p>
<h3 id="CellFactory-GetType"><a href="#CellFactory-GetType" class="headerlink" title="CellFactory_GetType"></a><code>CellFactory_GetType</code></h3><blockquote>
<p>CellFactory_GetType( material_name:string ) -&gt; int [Returns the id of a material.]</p>
</blockquote>
<p>输入材料名，返回材料id</p>
<h3 id="CellFactory-GetUIName"><a href="#CellFactory-GetUIName" class="headerlink" title="CellFactory_GetUIName"></a><code>CellFactory_GetUIName</code></h3><blockquote>
<p>CellFactory_GetUIName( material_id:int ) -&gt; string [Returns the displayed name of a material, or an empty string if ‘material_id’ is not valid. Might return a text key.]</p>
</blockquote>
<p>输入材料id，返回展ui_name。在materials.xml可以看到name，ui_name为不同的字段</p>
<h3 id="CellFactory-GetAllLiquids"><a href="#CellFactory-GetAllLiquids" class="headerlink" title="CellFactory_GetAllLiquids"></a><code>CellFactory_GetAllLiquids</code></h3><blockquote>
<p>CellFactory_GetAllLiquids( include_statics:bool = true, include_particle_fx_materials:bool = false ) -&gt; {string}</p>
</blockquote>
<p>可以无参数，默认为包括静态液体和粒子液体，可改为false，返回一个字符串表</p>
<p>测试两个参数为true/false区别的代码参考：<br><figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">local</span> t1 = CellFactory_GetAllLiquids()                     <span class="comment">-- 默认：包含静态和粒子特效材质</span></span><br><span class="line">    <span class="keyword">local</span> t2 = CellFactory_GetAllLiquids(<span class="literal">false</span>)                <span class="comment">-- 排除静态</span></span><br><span class="line">    <span class="keyword">local</span> t3 = CellFactory_GetAllLiquids(<span class="literal">false</span>, <span class="literal">false</span>)         <span class="comment">-- 排除静态和粒子材质</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">-- 转集合</span></span><br><span class="line">    <span class="keyword">local</span> <span class="function"><span class="keyword">function</span> <span class="title">list_to_set</span><span class="params">(list)</span></span></span><br><span class="line">        <span class="keyword">local</span> set = &#123;&#125;</span><br><span class="line">        <span class="keyword">for</span> _, v <span class="keyword">in</span> <span class="built_in">ipairs</span>(list) <span class="keyword">do</span></span><br><span class="line">            set[v] = <span class="literal">true</span></span><br><span class="line">        <span class="keyword">end</span></span><br><span class="line">        <span class="keyword">return</span> set</span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">local</span> set1 = list_to_set(t1)</span><br><span class="line">    <span class="keyword">local</span> set2 = list_to_set(t2)</span><br><span class="line">    <span class="keyword">local</span> set3 = list_to_set(t3)</span><br><span class="line"></span><br><span class="line">    <span class="comment">-- 差集打印</span></span><br><span class="line">    <span class="keyword">local</span> <span class="function"><span class="keyword">function</span> <span class="title">print_diff</span><span class="params">(name, base_set, compare_set)</span></span></span><br><span class="line">        GamePrint(<span class="string">&quot;=== &quot;</span> .. name .. <span class="string">&quot; 中独有的材料 ===&quot;</span>)</span><br><span class="line">        <span class="keyword">local</span> count = <span class="number">0</span></span><br><span class="line">        <span class="keyword">for</span> mat <span class="keyword">in</span> <span class="built_in">pairs</span>(base_set) <span class="keyword">do</span></span><br><span class="line">            <span class="keyword">if</span> <span class="keyword">not</span> compare_set[mat] <span class="keyword">then</span></span><br><span class="line">                GamePrint(mat)</span><br><span class="line">                count = count + <span class="number">1</span></span><br><span class="line">            <span class="keyword">end</span></span><br><span class="line">        <span class="keyword">end</span></span><br><span class="line">        <span class="keyword">if</span> count == <span class="number">0</span> <span class="keyword">then</span></span><br><span class="line">            GamePrint(<span class="string">&quot;（无）&quot;</span>)</span><br><span class="line">        <span class="keyword">end</span></span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">-- 打印数量</span></span><br><span class="line">    GamePrint(<span class="string">&quot;=== 总数 ===&quot;</span>)</span><br><span class="line">    GamePrint(<span class="string">&quot;t1 (默认): &quot;</span> .. <span class="built_in">tostring</span>(#t1))</span><br><span class="line">    GamePrint(<span class="string">&quot;t2 (无静态): &quot;</span> .. <span class="built_in">tostring</span>(#t2))</span><br><span class="line">    GamePrint(<span class="string">&quot;t3 (无静态无特效): &quot;</span> .. <span class="built_in">tostring</span>(#t3))</span><br><span class="line"></span><br><span class="line">    <span class="comment">-- 差集对比</span></span><br><span class="line">    print_diff(<span class="string">&quot;t1&quot;</span>, set1, set2)   <span class="comment">-- t1 - t2 = 静态液体</span></span><br><span class="line">    print_diff(<span class="string">&quot;t2&quot;</span>, set2, set3)   <span class="comment">-- t2 - t3 = 特效粒子液体</span></span><br></pre></td></tr></table></figure></p>
<h3 id="CellFactory-GetAllSands"><a href="#CellFactory-GetAllSands" class="headerlink" title="CellFactory_GetAllSands"></a><code>CellFactory_GetAllSands</code></h3><p>同上</p>
<h3 id="CellFactory-GetAllGases"><a href="#CellFactory-GetAllGases" class="headerlink" title="CellFactory_GetAllGases"></a><code>CellFactory_GetAllGases</code></h3><p>同上</p>
<h3 id="CellFactory-GetAllFires"><a href="#CellFactory-GetAllFires" class="headerlink" title="CellFactory_GetAllFires"></a><code>CellFactory_GetAllFires</code></h3><p>同上</p>
<h3 id="CellFactory-GetAllSolids"><a href="#CellFactory-GetAllSolids" class="headerlink" title="CellFactory_GetAllSolids"></a><code>CellFactory_GetAllSolids</code></h3><p>同上</p>
<h3 id="CellFactory-GetTags"><a href="#CellFactory-GetTags" class="headerlink" title="CellFactory_GetTags"></a><code>CellFactory_GetTags</code></h3><blockquote>
<p>CellFactory_GetTags( material_id:int ) -&gt; {string}</p>
</blockquote>
<p>获取某种材料的tags，输入材料id，返回字符串表</p>
<h3 id="CellFactory-HasTag"><a href="#CellFactory-HasTag" class="headerlink" title="CellFactory_HasTag"></a><code>CellFactory_HasTag</code></h3><blockquote>
<p>CellFactory_HasTag( material_id:int, tag:string ) -&gt; {bool}</p>
</blockquote>
<p>检查某种材料是否具有某个标签，输入材料id，标签（带中括号），返回一个bool值（不要被上面的{bool}骗了）</p>
<h2 id="射线"><a href="#射线" class="headerlink" title="射线"></a>射线</h2><h3 id="Raytrace"><a href="#Raytrace" class="headerlink" title="Raytrace"></a><code>Raytrace</code></h3><blockquote>
<p>Raytrace( x1:number, y1:number, x2:number, y2:number ) -&gt; did_hit:bool,hit_x:number,hit_y:number [Does a raytrace that stops on any cell it hits.]</p>
</blockquote>
<p>输入两对坐标，返回一个bool值是否碰撞，以及碰撞位置的坐标</p>
<p>开销在 200次/ms 左右，也就是每帧1000不会导致卡顿，局部性良好的话可以更高</p>
<h3 id="RaytraceSurfaces"><a href="#RaytraceSurfaces" class="headerlink" title="RaytraceSurfaces"></a><code>RaytraceSurfaces</code></h3><blockquote>
<p>RaytraceSurfaces( x1:number, y1:number, x2:number, y2:number ) -&gt; did_hit:bool,hit_x:number,hit_y:number [Does a raytrace that stops on any cell that is not fluid, gas (yes, technically gas is a fluid), or fire.]</p>
</blockquote>
<p>输入输出同上，但是碰撞不包括液体、气体和火焰，开销和Raytrace基本一致</p>
<h3 id="RaytraceSurfacesAndLiquiform"><a href="#RaytraceSurfacesAndLiquiform" class="headerlink" title="RaytraceSurfacesAndLiquiform"></a><code>RaytraceSurfacesAndLiquiform</code></h3><blockquote>
<p>RaytraceSurfacesAndLiquiform( x1:number, y1:number, x2:number, y2:number ) -&gt; did_hit:bool,hit_x:number,hit_y:number [Does a raytrace that stops on any cell that is not gas or fire.]</p>
</blockquote>
<p>检测碰撞任何除气体和火焰之外的像素，几乎没有局部性时开销和Raytrace基本一致，局部性良好的话开销比Raytrace高</p>
<h3 id="RaytracePlatforms"><a href="#RaytracePlatforms" class="headerlink" title="RaytracePlatforms"></a><code>RaytracePlatforms</code></h3><blockquote>
<p>RaytracePlatforms( x1:number, y1:number, x2:number, y2:number ) -&gt; did_hit:bool,hit_x:number,hit_y:number [Does a raytrace that stops on any cell a character can stand on.]</p>
</blockquote>
<p>碰撞标准是像素可以站上去，开销略高Raytrace一点点</p>
<h2 id="随机数"><a href="#随机数" class="headerlink" title="随机数"></a>随机数</h2><h3 id="Random"><a href="#Random" class="headerlink" title="Random"></a><code>Random</code></h3><blockquote>
<p>Random( a:int = optional, b:int = optional ) -&gt; number|int. [This is kinda messy. If given 0 arguments, returns number between 0.0 and 1.0. If given 1 arguments, returns int between 0 and ‘a’. If given 2 arguments returns int between ‘a’ and ‘b’.]</p>
</blockquote>
<p>生成随机整数，没有参数返回值范围是0~1，一个参数是0~a，两个参数是a~b</p>
<h3 id="Randomf"><a href="#Randomf" class="headerlink" title="Randomf"></a><code>Randomf</code></h3><blockquote>
<p>Randomf( min:number = optional, max:number = optional ) -&gt; number [This is kinda messy. If given 0 arguments, returns number between 0.0 and 1.0. If given 1 arguments, returns number between 0.0 and ‘a’. If given 2 arguments returns number between ‘a’ and ‘b’.]</p>
</blockquote>
<p>生成随机数，范围同Random</p>
<h3 id="RandomDistribution"><a href="#RandomDistribution" class="headerlink" title="RandomDistribution"></a><code>RandomDistribution</code></h3><blockquote>
<p>RandomDistribution( min:int, max:int, mean:int, sharpness:number = 1, baseline:number = 0.005 ) -&gt; int</p>
</blockquote>
<p>疑似是正态分布，输出最小值，最大值，均值，尖锐度，基线。返回一个整数</p>
<h3 id="RandomDistributionf"><a href="#RandomDistributionf" class="headerlink" title="RandomDistributionf"></a><code>RandomDistributionf</code></h3><blockquote>
<p>RandomDistributionf( min:number, max:number, mean:number, sharpness:number = 1, baseline:number = 0.005 ) -&gt; number</p>
</blockquote>
<p>同上，返回一个浮点数</p>
<h3 id="ProceduralRandom"><a href="#ProceduralRandom" class="headerlink" title="ProceduralRandom"></a><code>ProceduralRandom</code></h3><blockquote>
<p>ProceduralRandom( x:number, y:number, a:int|number = optional, b:int|number = optional ) -&gt; int|number [This is kinda messy. If given 2 arguments, returns number between 0.0 and 1.0. If given 3 arguments, returns int between 0 and ‘a’. If given 4 arguments returns number between ‘a’ and ‘b’.]</p>
</blockquote>
<p>x，y是随机的种子。输入两个参数，返回0.0到1.0之间的浮点数，三个参数，返回0到a之间的整数，四个参数，返回a到b之间的一个随机浮点数</p>
<h3 id="ProceduralRandomf"><a href="#ProceduralRandomf" class="headerlink" title="ProceduralRandomf"></a><code>ProceduralRandomf</code></h3><blockquote>
<p>ProceduralRandomf( x:number, y:number, a:number = optional, b:number = optional ) -&gt; number [This is kinda messy. If given 2 arguments, returns number between 0.0 and 1.0. If given 3 arguments, returns a number between 0 and ‘a’. If given 4 arguments returns a number between ‘a’ and ‘b’.]</p>
</blockquote>
<p>同上，但是只返回浮点数</p>
<h3 id="ProceduralRandomi"><a href="#ProceduralRandomi" class="headerlink" title="ProceduralRandomi"></a><code>ProceduralRandomi</code></h3><blockquote>
<p>ProceduralRandomi(  x:number, y:number, a:int = optional, b:int = optional ) -&gt; number [This is kinda messy. If given 2 arguments, returns 0 or 1. If given 3 arguments, returns an int between 0 and ‘a’. If given 4 arguments returns an int between ‘a’ and ‘b’.]</p>
</blockquote>
<p>x，y作为种子，两个参数返回0或1，三个参数返回0到a范围内的随机整数，四个参数返回a到b的整数</p>
<h2 id="战争之雾"><a href="#战争之雾" class="headerlink" title="战争之雾"></a>战争之雾</h2><p>就是全知之眼去掉的东西</p>
<h3 id="GameGetFogOfWar"><a href="#GameGetFogOfWar" class="headerlink" title="GameGetFogOfWar"></a><code>GameGetFogOfWar</code></h3><blockquote>
<p>GameGetFogOfWar( pos_x:number, pos_y:number ) -&gt; fog_of_war:int [Returns an integer between 0 and 255. Larger value means more coverage. Returns -1 if query is outside the bounds of the fog of war grid. For performance reasons consider using the components that manipulate fog of war.]</p>
</blockquote>
<p>获取战争之雾，输入坐标，返回一个0-255的整数，数值越大表示覆盖范围越大，-1表示表示超出战争之雾格子边界。</p>
<h3 id="GameGetFogOfWarBilinear"><a href="#GameGetFogOfWarBilinear" class="headerlink" title="GameGetFogOfWarBilinear"></a><code>GameGetFogOfWarBilinear</code></h3><blockquote>
<p>GameGetFogOfWarBilinear( pos_x:number, pos_y:number ) -&gt; fog_of_war:int [Returns an integer between 0 and 255. Larger value means more coverage. Returns -1 if query is outside the bounds of the fog of war grid. The value is bilinearly filtered using four samples around ‘pos’. For performance reasons consider using the components that manipulate fog of war.]</p>
</blockquote>
<p>通过对周围四个样本点进行插值，提供更平滑的迷雾覆盖结果。用法同上</p>
<h3 id="GameSetFogOfWar"><a href="#GameSetFogOfWar" class="headerlink" title="GameSetFogOfWar"></a><code>GameSetFogOfWar</code></h3><blockquote>
<p>GameSetFogOfWar( pos_x:number, pos_y:number, fog_of_war:int ) -&gt; pos_valid:bool [‘fog_of_war’ should be between 0 and 255 (but will be clamped to the correct range with a int32-&gt;uint8 cast). Larger value means more coverage. Returns a boolean indicating whether or not the position was inside the bounds of the fog of war grid. For performance reasons consider using the components that manipulate fog of war.]</p>
</blockquote>
<p>设置战争之雾的值，输入坐标，值，0-255之间越大范围越大，超出255会被强制转化。返回一个bool值表示是否输入坐标在战争之雾格子范围内</p>
<h2 id="全局变量"><a href="#全局变量" class="headerlink" title="全局变量"></a>全局变量</h2><p>noita有一系列api辅助管理全局变量</p>
<h3 id="GameAddFlagRun"><a href="#GameAddFlagRun" class="headerlink" title="GameAddFlagRun"></a><code>GameAddFlagRun</code></h3><blockquote>
<p>GameAddFlagRun( flag:string )</p>
</blockquote>
<p>flag可以看做一个bool型全局变量，add即初始化/由false改为true</p>
<h3 id="GameRemoveFlagRun"><a href="#GameRemoveFlagRun" class="headerlink" title="GameRemoveFlagRun"></a><code>GameRemoveFlagRun</code></h3><blockquote>
<p>GameRemoveFlagRun( flag:string )</p>
</blockquote>
<p>移走flag，可以近似认为把该全局变量设置为false</p>
<h3 id="GameHasFlagRun"><a href="#GameHasFlagRun" class="headerlink" title="GameHasFlagRun"></a><code>GameHasFlagRun</code></h3><blockquote>
<p>GameHasFlagRun( flag:string ) -&gt; bool</p>
</blockquote>
<p>获取该“全局变量”的值</p>
<h3 id="GlobalsSetValue"><a href="#GlobalsSetValue" class="headerlink" title="GlobalsSetValue"></a><code>GlobalsSetValue</code></h3><blockquote>
<p>GlobalsSetValue( key:string, value:string )</p>
</blockquote>
<p>设置一个全局变量，输入变量名，值（字符串）</p>
<h3 id="GlobalsGetValue"><a href="#GlobalsGetValue" class="headerlink" title="GlobalsGetValue"></a><code>GlobalsGetValue</code></h3><blockquote>
<p>GlobalsGetValue( key:string, default_value:string = “” )</p>
</blockquote>
<p>获取一个全局变量的值，输入变量名，默认值（变量不存在时的返回值，字符串），返回字符串，<strong>获取数字需要加上tonumber</strong></p>
<h3 id="AddFlagPersistent"><a href="#AddFlagPersistent" class="headerlink" title="AddFlagPersistent"></a><code>AddFlagPersistent</code></h3><blockquote>
<p>AddFlagPersistent( key:string ) -&gt; bool_is_new</p>
</blockquote>
<p>输入字符串，增加一个永久flag，跨存档持久化的，游戏内用于各种进展</p>
<h3 id="HasFlagPersistent"><a href="#HasFlagPersistent" class="headerlink" title="HasFlagPersistent"></a><code>HasFlagPersistent</code></h3><blockquote>
<p>HasFlagPersistent( key:string ) -&gt; bool</p>
</blockquote>
<p>检查是否有某个永久flag</p>
<h3 id="RemoveFlagPersistent"><a href="#RemoveFlagPersistent" class="headerlink" title="RemoveFlagPersistent"></a><code>RemoveFlagPersistent</code></h3><blockquote>
<p>RemoveFlagPersistent( key:string )</p>
</blockquote>
<p>移除某个永久flag</p>
<h2 id="Camera"><a href="#Camera" class="headerlink" title="Camera"></a>Camera</h2><h3 id="GameGetCameraPos"><a href="#GameGetCameraPos" class="headerlink" title="GameGetCameraPos"></a><code>GameGetCameraPos</code></h3><blockquote>
<p>GameGetCameraPos() -&gt; x:number,y:number</p>
</blockquote>
<p>获取当前相机位置，返回坐标</p>
<h3 id="GameSetCameraPos"><a href="#GameSetCameraPos" class="headerlink" title="GameSetCameraPos"></a><code>GameSetCameraPos</code></h3><blockquote>
<p>GameSetCameraPos( x:number, y:number )</p>
</blockquote>
<p>设置镜头位置</p>
<h3 id="GameSetCameraFree"><a href="#GameSetCameraFree" class="headerlink" title="GameSetCameraFree"></a><code>GameSetCameraFree</code></h3><blockquote>
<p>GameSetCameraFree( is_free:bool )</p>
</blockquote>
<p>设置镜头自由与否（是否绑在米娜身上），自由后可以控制移动</p>
<h3 id="GameGetCameraBounds"><a href="#GameGetCameraBounds" class="headerlink" title="GameGetCameraBounds"></a><code>GameGetCameraBounds</code></h3><blockquote>
<p>GameGetCameraBounds() -&gt; x:number,y:number,w:number,h:number [Returns the camera rectangle. This may not be 100% pixel perfect with regards to what you see on the screen. ‘x’,’y’ = top left corner of the rectangle.]</p>
</blockquote>
<p>获取镜头边界，一个长方形，返回左上角坐标，宽、高</p>
<h2 id="混乱变形"><a href="#混乱变形" class="headerlink" title="混乱变形"></a>混乱变形</h2><p>游戏有一个混乱变形表，里面存着混乱变形效果生效的范围</p>
<h3 id="PolymorphTableAddEntity"><a href="#PolymorphTableAddEntity" class="headerlink" title="PolymorphTableAddEntity"></a><code>PolymorphTableAddEntity</code></h3><blockquote>
<p>PolymorphTableAddEntity( entity_xml:string, is_rare:bool = false, add_only_one_copy:bool = true ) [Adds the entity to the polymorph random table]</p>
</blockquote>
<p>往表里增加实体，参数为：xml路径名，两个bool变量，意义不明</p>
<h3 id="PolymorphTableRemoveEntity"><a href="#PolymorphTableRemoveEntity" class="headerlink" title="PolymorphTableRemoveEntity"></a><code>PolymorphTableRemoveEntity</code></h3><blockquote>
<p>PolymorphTableRemoveEntity( entity_xml:string, from_common_table:bool = true, from_rare_table:bool = true ) [Removes the entity from the polymorph random table]</p>
</blockquote>
<p>从表里移除实体，同上</p>
<h3 id="PolymorphTableGet"><a href="#PolymorphTableGet" class="headerlink" title="PolymorphTableGet"></a><code>PolymorphTableGet</code></h3><blockquote>
<p>PolymorphTableGet( bool rare_table = false ) -&gt; {string} [Returns a list of all the entities in the polymorph random table]</p>
</blockquote>
<p>获取表的信息，全部实体</p>
<h3 id="PolymorphTableSet"><a href="#PolymorphTableSet" class="headerlink" title="PolymorphTableSet"></a><code>PolymorphTableSet</code></h3><blockquote>
<p>PolymorphTableSet( {table_of_xml_entities}, bool rare_table = false ) [Set a list of all entities sas the polymorph random table]</p>
</blockquote>
<p>重新设置表，使用参考：<br><figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">set_worm_only_polymorph</span><span class="params">()</span></span></span><br><span class="line">	<span class="keyword">local</span> worm_entities = &#123;</span><br><span class="line">        <span class="string">&quot;data/entities/animals/worm.xml&quot;</span>,           <span class="comment">-- 普通蠕虫</span></span><br><span class="line">		<span class="string">&quot;data/entities/animals/worm_big.xml&quot;</span>,       <span class="comment">-- 大蠕虫</span></span><br><span class="line">		<span class="string">&quot;data/entities/animals/worm_tiny.xml&quot;</span>,      <span class="comment">-- 小蠕虫</span></span><br><span class="line">		<span class="string">&quot;data/entities/animals/worm_end.xml&quot;</span>,       <span class="comment">-- 地狱蠕虫</span></span><br><span class="line">		<span class="string">&quot;data/entities/animals/worm_skull.xml&quot;</span>      <span class="comment">-- 幽灵蠕虫</span></span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	PolymorphTableSet(worm_entities, <span class="literal">false</span>)</span><br><span class="line">	PolymorphTableSet(&#123;&#125;, <span class="literal">true</span>)</span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure></p>
<h2 id="Herd（阵营）"><a href="#Herd（阵营）" class="headerlink" title="Herd（阵营）"></a>Herd（阵营）</h2><p>noita的生物都有一个阵营字段，详细可以参考<a target="_blank" rel="noopener" href="https://noita.wiki.gg/zh/wiki/%E6%95%8C%E4%BA%BA%E9%98%B5%E8%90%A5">这里</a></p>
<h3 id="StringToHerdId"><a href="#StringToHerdId" class="headerlink" title="StringToHerdId"></a><code>StringToHerdId</code></h3><blockquote>
<p>StringToHerdId( herd_name:string  ) -&gt; int</p>
</blockquote>
<p>输入阵营字符串，返回阵营id</p>
<h3 id="HerdIdToString"><a href="#HerdIdToString" class="headerlink" title="HerdIdToString"></a><code>HerdIdToString</code></h3><blockquote>
<p>HerdIdToString( herd_id:int ) -&gt; string</p>
</blockquote>
<p>上一个的逆过程，输入id返回字符串</p>
<h3 id="GetHerdRelation"><a href="#GetHerdRelation" class="headerlink" title="GetHerdRelation"></a><code>GetHerdRelation</code></h3><blockquote>
<p>GetHerdRelation( herd_id_a:int, herd_id_b:int ) -&gt; number</p>
</blockquote>
<p>获取阵营关系，输入两个阵营id，返回一个数，越高越友善（可以直接去wiki查表的）</p>
<h3 id="EntityGetHerdRelation"><a href="#EntityGetHerdRelation" class="headerlink" title="EntityGetHerdRelation"></a><code>EntityGetHerdRelation</code></h3><blockquote>
<p>EntityGetHerdRelation( entity_a:int, entity_b:int ) -&gt; number</p>
</blockquote>
<p>输入两个实体id，返回友善程度（不被攻击的概率）</p>
<h3 id="EntityGetHerdRelationSafe"><a href="#EntityGetHerdRelationSafe" class="headerlink" title="EntityGetHerdRelationSafe"></a><code>EntityGetHerdRelationSafe</code></h3><blockquote>
<p>EntityGetHerdRelationSafe( entity_a:int, entity_b:int ) -&gt; number [does not spam errors, but returns 0 if anything fails]</p>
</blockquote>
<p>上一个函数的安全版本，指出错了返回0，其余一致</p>
<h2 id="其它"><a href="#其它" class="headerlink" title="其它"></a>其它</h2><h3 id="GetParallelWorldPosition"><a href="#GetParallelWorldPosition" class="headerlink" title="GetParallelWorldPosition"></a><code>GetParallelWorldPosition</code></h3><blockquote>
<p>GetParallelWorldPosition( world_pos_x:number, world_pos_y:number ) -&gt; x, y [x = 0 normal world, -1 is first west world, +1 is first east world, if y &lt; 0 it is sky, if y &gt; 0 it is hell ]</p>
</blockquote>
<p>输入坐标，返回x,y。x表示平行世界值，0为主世界，-1为第一个西方向世界，1为第一个东方向世界，y<0表明在天堂，y>0表明在地狱</p>
<h3 id="IsPlayer"><a href="#IsPlayer" class="headerlink" title="IsPlayer"></a><code>IsPlayer</code></h3><blockquote>
<p>IsPlayer( entity_id:int ) -&gt; bool</p>
</blockquote>
<p>输入实体id，返回是否是玩家</p>
<h3 id="IsInvisible"><a href="#IsInvisible" class="headerlink" title="IsInvisible"></a><code>IsInvisible</code></h3><blockquote>
<p>IsInvisible( entity_id:int ) -&gt; bool</p>
</blockquote>
<p>输入实体id，返回是否不可见</p>
<h3 id="GameIsDailyRun"><a href="#GameIsDailyRun" class="headerlink" title="GameIsDailyRun"></a><code>GameIsDailyRun</code></h3><blockquote>
<p>GameIsDailyRun() -&gt; bool</p>
</blockquote>
<p>是否是每日挑战</p>
<h3 id="GameIsDailyRunOrDailyPracticeRun"><a href="#GameIsDailyRunOrDailyPracticeRun" class="headerlink" title="GameIsDailyRunOrDailyPracticeRun"></a><code>GameIsDailyRunOrDailyPracticeRun</code></h3><blockquote>
<p>GameIsDailyRunOrDailyPracticeRun() -&gt; bool</p>
</blockquote>
<p>是否是每日挑战或每日练习</p>
<h3 id="GameIsModeFullyDeterministic"><a href="#GameIsModeFullyDeterministic" class="headerlink" title="GameIsModeFullyDeterministic"></a><code>GameIsModeFullyDeterministic</code></h3><blockquote>
<p>GameIsModeFullyDeterministic() -&gt; bool</p>
</blockquote>
<p>游戏是否完全确定（有待进一步测试用法）</p>
<h3 id="dofile"><a href="#dofile" class="headerlink" title="dofile"></a><code>dofile</code></h3><blockquote>
<p>dofile( filename:string ) -&gt; (nil|script_return_type)|(nil,error_string) [Returns the script’s return value, if any. Returns nil,error_string if the script had errors.]</p>
</blockquote>
<p>输入一个文件，返回脚本的返回值，或nil</p>
<h3 id="dofile-once"><a href="#dofile-once" class="headerlink" title="dofile_once"></a><code>dofile_once</code></h3><blockquote>
<p>dofile_once( filename:string ) -&gt; (nil|script_return_type)|(nil,error_string) [Runs the script only once per lua context, returns the script’s return value, if any. Returns nil,error_string if the script had errors. For performance reasons it is recommended scripts use dofile_once(), unless the standard dofile behaviour is required.]</p>
</blockquote>
<p>同上，保证不重复执行脚本，用于替代dofile</p>
</article><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/lua/">lua</a><a class="post-meta__tags" href="/tags/noita/">noita</a></div></div><nav class="pagination-post" id="pagination"><a class="pagination-related" href="/2025/07/28/CSAPP-%E7%AC%AC%E5%9B%9B%E7%AB%A0/" title="CSAPP-第四章"><img class="cover" src="/image/cover24_joy.jpg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="info"><div class="info-1"><div class="info-item-1">上一篇</div><div class="info-item-2">CSAPP-第四章</div></div><div class="info-2"><div class="info-item-1">*4.45 在3.4.2节中，x86-64 pushq 指令被描述成要减少栈指针，然后将寄存器存储在栈指针的位置。因此，如果我们有一条指令形如对于某个寄存器 REG, pushq REG, 它等价千下面的代码序列：12subq $8,%rsp  Decrement stack pointermovq REG, (%rsp)  Store REG on stackA. 借助于练习题 4.7中所做的分析，这段代码序列正确地描述了指令 pushq %rsp 的行为吗？请解释。 B. 你该如何改写这段代码序列，使得它能够像对 REG 是其他寄存器时一样，正确地描述 REG 是%rsp 的情况？  正常来说入栈是栈指针下移，把值放到栈上，但是pushq %rsp时，如果真的有这行代码，存的值是下移前还是后就产生了歧义。4.7告诉我们存的是没有减小的栈指针，所以题目所给的汇编代码是不正确的 修改的话：12movq REG, (%rsp-8)subq $8,%rsp  *4.46 3.4.2节中， x86-64 popq...</div></div></div></a><a class="pagination-related" href="/2025/08/05/%E9%BE%9F%E5%85%94%E8%B5%9B%E8%B7%91/" title="睡前故事：龟兔赛跑"><img class="cover" src="/image/cover25_sunshine.jpg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="info text-right"><div class="info-1"><div class="info-item-1">下一篇</div><div class="info-item-2">睡前故事：龟兔赛跑</div></div><div class="info-2"><div class="info-item-1">...</div></div></div></a></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>相关推荐</span></div><div class="relatedPosts-list"><a class="pagination-related" href="/2025/06/28/noita-mode-0/" title="noita_mode_0"><img class="cover" src="/image/cover14_soft.jpg" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-06-28</div><div class="info-item-2">noita_mode_0</div></div><div class="info-2"><div class="info-item-1">本文用于记录本人的第一个noita的mod开发过程 新建文件夹第一步，在mods文件夹下新建文件夹 一个模组至少包括两个文件，mod.xml和init.lua 关于.xml文件在pom.xml里已经被折磨过见过了，重新从头认识一下：eXtensible Markup Language，意为”可扩展标记语言”。 声明（可以没有，noita的文件都没有）：1&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt; 交代编码方式 元素和属性元素用成对的标签包裹内容，属性附着在起始标签上提供附加信息，必须加引号 1234567891011&lt;Mod	name=&quot;Daily Practice Run&quot;	description=&quot;You can practice by replaying the same seed within 24...</div></div></div></a><a class="pagination-related" href="/2025/06/24/lua%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/" title="lua学习笔记（持续更新中）"><img class="cover" src="/image/cover9_star.jpg" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-06-24</div><div class="info-item-2">lua学习笔记（持续更新中）</div></div><div class="info-2"><div class="info-item-1">🌙 前言开始之前先记录一下与lua的结缘过程：  Noita的法术编程系统是用lua写的，早就想从源码层面研究一下noita了 上学期cpp课老师建议我用lua给我的小游戏写个引擎 lua是葡萄牙语中”月亮“的意思，对美丽的名字没有任何抵抗力！ 听说了一些诸如某初中生在 nspire 上用lua 写东西的故事  总而言之，既c和cpp之后第三门认真学的语言（是的到现在py、js、java、html、asm还没认真学过）就这么愉快的决定了 环境在线运行环境：可以在网页里运行  windows解释器  把.exe文件所在目录添加到环境变量里即可，lua对环境的要求很低 资料中文文档  语法Hello world1print(&quot;hello world&quot;) 简洁明了 变量声明赋值就是声明，默认为全局变量，加上local关键字变为局部变量 一切没声明的变量都是nil 支持多重赋值：1a,b = 1 ,2 数据类型 number: lua的数字只有一个类型，为c里的double，支持16进制表示、科学计数法、左移右移运算 string:...</div></div></div></a><a class="pagination-related" href="/2025/07/09/%E5%A4%8D%E6%9D%822d%E6%B8%B8%E6%88%8F%E5%9C%B0%E5%9B%BE%E4%B8%8A%E7%9A%84%E8%87%AA%E5%8A%A8%E5%8C%96%E5%AF%BB%E8%B7%AF%E7%AE%97%E6%B3%95%E8%AE%BE%E8%AE%A1/" title="复杂2d游戏地图上的自动化寻路算法设计"><img class="cover" src="/image/cover18_spirit.jpg" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-07-09</div><div class="info-item-2">复杂2d游戏地图上的自动化寻路算法设计</div></div><div class="info-2"><div class="info-item-1">...</div></div></div></a></div></div><hr class="custom-hr"/><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="fas fa-comments fa-fw"></i><span> 评论</span></div></div><div class="comment-wrap"><div><div id="giscus-wrap"></div></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info text-center"><div class="avatar-img"><img src="/img/auceptin-icon.png" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info-name">Auceptin.Fang</div><div class="author-info-description"></div><div class="site-data"><a href="/archives/"><div class="headline">文章</div><div class="length-num">29</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">27</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">8</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/auceptinFang"><i class="fab fa-github"></i><span>Follow Me</span></a></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>公告</span></div><div class="announcement_content">welcome to my blog! <br> Contact：me@aucept.in</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%B0%83%E8%AF%95%E7%9B%B8%E5%85%B3"><span class="toc-number">1.</span> <span class="toc-text">调试相关</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#GamePrint"><span class="toc-number">1.1.</span> <span class="toc-text">GamePrint</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#GamePrintImportant"><span class="toc-number">1.2.</span> <span class="toc-text">GamePrintImportant</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#GameGetRealWorldTimeSinceStarted"><span class="toc-number">1.3.</span> <span class="toc-text">GameGetRealWorldTimeSinceStarted</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#GameGetFrameNum"><span class="toc-number">1.4.</span> <span class="toc-text">GameGetFrameNum</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#GameGetDateAndTimeUTC"><span class="toc-number">1.5.</span> <span class="toc-text">GameGetDateAndTimeUTC</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#GameGetDateAndTimeLocal"><span class="toc-number">1.6.</span> <span class="toc-text">GameGetDateAndTimeLocal</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#SetTimeOut"><span class="toc-number">1.7.</span> <span class="toc-text">SetTimeOut</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#SetWorldSeed"><span class="toc-number">1.8.</span> <span class="toc-text">SetWorldSeed</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#SetPlayerSpawnLocation"><span class="toc-number">1.9.</span> <span class="toc-text">SetPlayerSpawnLocation</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#SetRandomSeed"><span class="toc-number">1.10.</span> <span class="toc-text">SetRandomSeed</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#DEBUG-GetMouseWorld"><span class="toc-number">1.11.</span> <span class="toc-text">DEBUG_GetMouseWorld</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#DEBUG-MARK"><span class="toc-number">1.12.</span> <span class="toc-text">DEBUG_MARK</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AE%9E%E4%BD%93Entity%E2%80%A6%E2%80%A6"><span class="toc-number">2.</span> <span class="toc-text">实体Entity……</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#EntityLoad"><span class="toc-number">2.1.</span> <span class="toc-text">EntityLoad</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#EntityLoadEndGameItem"><span class="toc-number">2.2.</span> <span class="toc-text">EntityLoadEndGameItem</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#EntityKill"><span class="toc-number">2.3.</span> <span class="toc-text">EntityKill</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#EntityCreateNew"><span class="toc-number">2.4.</span> <span class="toc-text">EntityCreateNew</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#EntityLoadCameraBound"><span class="toc-number">2.5.</span> <span class="toc-text">EntityLoadCameraBound</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#EntityGetWithTag"><span class="toc-number">2.6.</span> <span class="toc-text">EntityGetWithTag</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#EntityGetInRadius"><span class="toc-number">2.7.</span> <span class="toc-text">EntityGetInRadius</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#EntityGetInRadiusWithTag"><span class="toc-number">2.8.</span> <span class="toc-text">EntityGetInRadiusWithTag</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#EntityGetClosest"><span class="toc-number">2.9.</span> <span class="toc-text">EntityGetClosest</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#EntityGetClosestWithTag"><span class="toc-number">2.10.</span> <span class="toc-text">EntityGetClosestWithTag</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#EntityGetWithName"><span class="toc-number">2.11.</span> <span class="toc-text">EntityGetWithName</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#EntityGetTransform"><span class="toc-number">2.12.</span> <span class="toc-text">EntityGetTransform</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#EntitySetTransform"><span class="toc-number">2.13.</span> <span class="toc-text">EntitySetTransform</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#EntityApplyTransform"><span class="toc-number">2.14.</span> <span class="toc-text">EntityApplyTransform</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#EntityGetName"><span class="toc-number">2.15.</span> <span class="toc-text">EntityGetName</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#EntitySetName"><span class="toc-number">2.16.</span> <span class="toc-text">EntitySetName</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#EntityGetTags"><span class="toc-number">2.17.</span> <span class="toc-text">EntityGetTags</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#EntityAddTag"><span class="toc-number">2.18.</span> <span class="toc-text">EntityAddTag</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#EntityRemoveTag"><span class="toc-number">2.19.</span> <span class="toc-text">EntityRemoveTag</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#EntityHasTag"><span class="toc-number">2.20.</span> <span class="toc-text">EntityHasTag</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#EntityGetFilename"><span class="toc-number">2.21.</span> <span class="toc-text">EntityGetFilename</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#EntitiesGetMaxID"><span class="toc-number">2.22.</span> <span class="toc-text">EntitiesGetMaxID</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#EntityGetIsAlive"><span class="toc-number">2.23.</span> <span class="toc-text">EntityGetIsAlive</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#EntityAddComponent"><span class="toc-number">2.24.</span> <span class="toc-text">EntityAddComponent</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#EntityAddComponent2"><span class="toc-number">2.25.</span> <span class="toc-text">EntityAddComponent2</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#EntityRemoveComponent"><span class="toc-number">2.26.</span> <span class="toc-text">EntityRemoveComponent</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#EntityGetAllComponents"><span class="toc-number">2.27.</span> <span class="toc-text">EntityGetAllComponents</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#EntityGetComponent"><span class="toc-number">2.28.</span> <span class="toc-text">EntityGetComponent</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#EntityGetFirstComponent"><span class="toc-number">2.29.</span> <span class="toc-text">EntityGetFirstComponent</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#EntityGetComponentIncludingDisabled"><span class="toc-number">2.30.</span> <span class="toc-text">EntityGetComponentIncludingDisabled</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#EntityGetFirstComponentIncludingDisabled"><span class="toc-number">2.31.</span> <span class="toc-text">EntityGetFirstComponentIncludingDisabled</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#EntitySetComponentIsEnabled"><span class="toc-number">2.32.</span> <span class="toc-text">EntitySetComponentIsEnabled</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#EntitySetComponentsWithTagEnabled"><span class="toc-number">2.33.</span> <span class="toc-text">EntitySetComponentsWithTagEnabled</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#EntityAddChild"><span class="toc-number">2.34.</span> <span class="toc-text">EntityAddChild</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#EntityGetAllChildren"><span class="toc-number">2.35.</span> <span class="toc-text">EntityGetAllChildren</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#EntityGetParent"><span class="toc-number">2.36.</span> <span class="toc-text">EntityGetParent</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#EntityRemoveFromParent"><span class="toc-number">2.37.</span> <span class="toc-text">EntityRemoveFromParent</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#EntityGetRootEntity"><span class="toc-number">2.38.</span> <span class="toc-text">EntityGetRootEntity</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#EntityLoadToEntity"><span class="toc-number">2.39.</span> <span class="toc-text">EntityLoadToEntity</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#EntitySave"><span class="toc-number">2.40.</span> <span class="toc-text">EntitySave</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%BB%84%E4%BB%B6Component%E2%80%A6%E2%80%A6"><span class="toc-number">3.</span> <span class="toc-text">组件Component……</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#ComponentGetValue2"><span class="toc-number">3.1.</span> <span class="toc-text">ComponentGetValue2</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#ComponentSetValue2"><span class="toc-number">3.2.</span> <span class="toc-text">ComponentSetValue2</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#ComponentObjectGetValue2"><span class="toc-number">3.3.</span> <span class="toc-text">ComponentObjectGetValue2</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#ComponentObjectSetValue2"><span class="toc-number">3.4.</span> <span class="toc-text">ComponentObjectSetValue2</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#ComponentAddTag"><span class="toc-number">3.5.</span> <span class="toc-text">ComponentAddTag</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#ComponentRemoveTag"><span class="toc-number">3.6.</span> <span class="toc-text">ComponentRemoveTag</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#ComponentGetTags"><span class="toc-number">3.7.</span> <span class="toc-text">ComponentGetTags</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#ComponentHasTag"><span class="toc-number">3.8.</span> <span class="toc-text">ComponentHasTag</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#ComponentGetIsEnabled"><span class="toc-number">3.9.</span> <span class="toc-text">ComponentGetIsEnabled</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#ComponentGetEntity"><span class="toc-number">3.10.</span> <span class="toc-text">ComponentGetEntity</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#ComponentGetMembers"><span class="toc-number">3.11.</span> <span class="toc-text">ComponentGetMembers</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#ComponentObjectGetMembers"><span class="toc-number">3.12.</span> <span class="toc-text">ComponentObjectGetMembers</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#ComponentGetTypeName"><span class="toc-number">3.13.</span> <span class="toc-text">ComponentGetTypeName</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%85%B6%E5%AE%83%E5%AE%9E%E4%BD%93-%E7%BB%84%E4%BB%B6%E7%9B%B8%E5%85%B3"><span class="toc-number">4.</span> <span class="toc-text">其它实体&#x2F;组件相关</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#GetUpdatedEntityID"><span class="toc-number">4.1.</span> <span class="toc-text">GetUpdatedEntityID</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#GetUpdatedComponentID"><span class="toc-number">4.2.</span> <span class="toc-text">GetUpdatedComponentID</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#EntityInflictDamage"><span class="toc-number">4.3.</span> <span class="toc-text">EntityInflictDamage</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#EntityIngestMaterial"><span class="toc-number">4.4.</span> <span class="toc-text">EntityIngestMaterial</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#EntityRemoveIngestionStatusEffect"><span class="toc-number">4.5.</span> <span class="toc-text">EntityRemoveIngestionStatusEffect</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#EntityRemoveStainStatusEffect"><span class="toc-number">4.6.</span> <span class="toc-text">EntityRemoveStainStatusEffect</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#EntityAddRandomStains"><span class="toc-number">4.7.</span> <span class="toc-text">EntityAddRandomStains</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#EntitySetDamageFromMaterial"><span class="toc-number">4.8.</span> <span class="toc-text">EntitySetDamageFromMaterial</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#EntityRefreshSprite"><span class="toc-number">4.9.</span> <span class="toc-text">EntityRefreshSprite</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#EntityGetWandCapacity"><span class="toc-number">4.10.</span> <span class="toc-text">EntityGetWandCapacity</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#EntityGetHotspot"><span class="toc-number">4.11.</span> <span class="toc-text">EntityGetHotspot</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#EntityGetFirstHitboxCenter"><span class="toc-number">4.12.</span> <span class="toc-text">EntityGetFirstHitboxCenter</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Game%E2%80%A6%E2%80%A6"><span class="toc-number">5.</span> <span class="toc-text">Game……</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#GameScreenshake"><span class="toc-number">5.1.</span> <span class="toc-text">GameScreenshake</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#GameOnCompleted"><span class="toc-number">5.2.</span> <span class="toc-text">GameOnCompleted</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#GameGiveAchievement"><span class="toc-number">5.3.</span> <span class="toc-text">GameGiveAchievement</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#GameDoEnding2"><span class="toc-number">5.4.</span> <span class="toc-text">GameDoEnding2()</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#GameIsIntroPlaying"><span class="toc-number">5.5.</span> <span class="toc-text">GameIsIntroPlaying</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#GameGetIsGamepadConnected"><span class="toc-number">5.6.</span> <span class="toc-text">GameGetIsGamepadConnected</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#GameGetWorldStateEntity"><span class="toc-number">5.7.</span> <span class="toc-text">GameGetWorldStateEntity</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#GameGetPlayerStatsEntity"><span class="toc-number">5.8.</span> <span class="toc-text">GameGetPlayerStatsEntity</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#GameGetOrbCountAllTime"><span class="toc-number">5.9.</span> <span class="toc-text">GameGetOrbCountAllTime</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#GameGetOrbCountThisRun"><span class="toc-number">5.10.</span> <span class="toc-text">GameGetOrbCountThisRun</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#GameGetOrbCollectedThisRun"><span class="toc-number">5.11.</span> <span class="toc-text">GameGetOrbCollectedThisRun</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#GameGetOrbCollectedAllTime"><span class="toc-number">5.12.</span> <span class="toc-text">GameGetOrbCollectedAllTime</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#GameClearOrbsFoundThisRun"><span class="toc-number">5.13.</span> <span class="toc-text">GameClearOrbsFoundThisRun</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#GameGetOrbCountTotal"><span class="toc-number">5.14.</span> <span class="toc-text">GameGetOrbCountTotal</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#GameRegenItemAction"><span class="toc-number">5.15.</span> <span class="toc-text">GameRegenItemAction</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#GameRegenItemActionsInContainer"><span class="toc-number">5.16.</span> <span class="toc-text">GameRegenItemActionsInContainer</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#GameRegenItemActionsInPlayer"><span class="toc-number">5.17.</span> <span class="toc-text">GameRegenItemActionsInPlayer</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#GameKillInventoryItem"><span class="toc-number">5.18.</span> <span class="toc-text">GameKillInventoryItem</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#GamePickUpInventoryItem"><span class="toc-number">5.19.</span> <span class="toc-text">GamePickUpInventoryItem</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#GameGetAllInventoryItems"><span class="toc-number">5.20.</span> <span class="toc-text">GameGetAllInventoryItems</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#GameDropAllItems"><span class="toc-number">5.21.</span> <span class="toc-text">GameDropAllItems</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#GameDropPlayerInventoryItems"><span class="toc-number">5.22.</span> <span class="toc-text">GameDropPlayerInventoryItems</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#GameDestroyInventoryItems"><span class="toc-number">5.23.</span> <span class="toc-text">GameDestroyInventoryItems</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#GameIsInventoryOpen"><span class="toc-number">5.24.</span> <span class="toc-text">GameIsInventoryOpen</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#GameTriggerGameOver"><span class="toc-number">5.25.</span> <span class="toc-text">GameTriggerGameOver</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#GameShootProjectile"><span class="toc-number">5.26.</span> <span class="toc-text">GameShootProjectile</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#GameCreateSpriteForXFrames"><span class="toc-number">5.27.</span> <span class="toc-text">GameCreateSpriteForXFrames</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#GUI"><span class="toc-number">6.</span> <span class="toc-text">GUI</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#GuiCreate"><span class="toc-number">6.1.</span> <span class="toc-text">GuiCreate</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#GuiDestroy"><span class="toc-number">6.2.</span> <span class="toc-text">GuiDestroy</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#GuiStartFrame"><span class="toc-number">6.3.</span> <span class="toc-text">GuiStartFrame</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#GuiOptionsAdd"><span class="toc-number">6.4.</span> <span class="toc-text">GuiOptionsAdd</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#GuiOptionsAddForNextWidget"><span class="toc-number">6.5.</span> <span class="toc-text">GuiOptionsAddForNextWidget</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#GuiOptionsRemove"><span class="toc-number">6.6.</span> <span class="toc-text">GuiOptionsRemove</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#GuiOptionsClear"><span class="toc-number">6.7.</span> <span class="toc-text">GuiOptionsClear</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#GuiZSet"><span class="toc-number">6.8.</span> <span class="toc-text">GuiZSet</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#GuiZSetForNextWidget"><span class="toc-number">6.9.</span> <span class="toc-text">GuiZSetForNextWidget</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#GuiText"><span class="toc-number">6.10.</span> <span class="toc-text">GuiText</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#GuiIdPush"><span class="toc-number">6.11.</span> <span class="toc-text">GuiIdPush</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#GuiIdPushString"><span class="toc-number">6.12.</span> <span class="toc-text">GuiIdPushString</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#GuiIdPop"><span class="toc-number">6.13.</span> <span class="toc-text">GuiIdPop</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#GuiButton"><span class="toc-number">6.14.</span> <span class="toc-text">GuiButton</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#GuiImageButton"><span class="toc-number">6.15.</span> <span class="toc-text">GuiImageButton</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#GuiImage"><span class="toc-number">6.16.</span> <span class="toc-text">GuiImage</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#GuiImageNinePiece"><span class="toc-number">6.17.</span> <span class="toc-text">GuiImageNinePiece</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#GuiTextInput"><span class="toc-number">6.18.</span> <span class="toc-text">GuiTextInput</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#GuiGetScreenDimensions"><span class="toc-number">6.19.</span> <span class="toc-text">GuiGetScreenDimensions</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#GuiGetPreviousWidgetInfo"><span class="toc-number">6.20.</span> <span class="toc-text">GuiGetPreviousWidgetInfo</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#GuiColorSetForNextWidget"><span class="toc-number">6.21.</span> <span class="toc-text">GuiColorSetForNextWidget</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%B2%92%E5%AD%90"><span class="toc-number">7.</span> <span class="toc-text">粒子</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#GameCreateCosmeticParticle"><span class="toc-number">7.1.</span> <span class="toc-text">GameCreateCosmeticParticle</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#GameCreateParticle"><span class="toc-number">7.2.</span> <span class="toc-text">GameCreateParticle</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Input%E2%80%A6%E2%80%A6"><span class="toc-number">8.</span> <span class="toc-text">Input……</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#InputIsKeyDown"><span class="toc-number">8.1.</span> <span class="toc-text">InputIsKeyDown</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#InputIsKeyJustDown"><span class="toc-number">8.2.</span> <span class="toc-text">InputIsKeyJustDown</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#InputIsKeyJustUp"><span class="toc-number">8.3.</span> <span class="toc-text">InputIsKeyJustUp</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#InputGetMousePosOnScreen"><span class="toc-number">8.4.</span> <span class="toc-text">InputGetMousePosOnScreen</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#InputIsMouseButtonDown"><span class="toc-number">8.5.</span> <span class="toc-text">InputIsMouseButtonDown</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#InputIsMouseButtonJustDown"><span class="toc-number">8.6.</span> <span class="toc-text">InputIsMouseButtonJustDown</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#InputIsMouseButtonJustUp"><span class="toc-number">8.7.</span> <span class="toc-text">InputIsMouseButtonJustUp</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#InputIsJoystickButtonDown"><span class="toc-number">8.8.</span> <span class="toc-text">InputIsJoystickButtonDown</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#InputIsJoystickButtonJustDown"><span class="toc-number">8.9.</span> <span class="toc-text">InputIsJoystickButtonJustDown</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#InputGetJoystickAnalogButton"><span class="toc-number">8.10.</span> <span class="toc-text">InputGetJoystickAnalogButton</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#InputIsJoystickConnected"><span class="toc-number">8.11.</span> <span class="toc-text">InputIsJoystickConnected</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#InputGetJoystickAnalogStick"><span class="toc-number">8.12.</span> <span class="toc-text">InputGetJoystickAnalogStick</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Biome%E2%80%A6%E2%80%A6%EF%BC%88%E7%BE%A4%E7%B3%BB%EF%BC%89"><span class="toc-number">9.</span> <span class="toc-text">Biome……（群系）</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#BiomeMapLoad-KeepPlayer"><span class="toc-number">9.1.</span> <span class="toc-text">BiomeMapLoad_KeepPlayer</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#BiomeSetValue"><span class="toc-number">9.2.</span> <span class="toc-text">BiomeSetValue</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#BiomeGetValue"><span class="toc-number">9.3.</span> <span class="toc-text">BiomeGetValue</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#BiomeObjectSetValue"><span class="toc-number">9.4.</span> <span class="toc-text">BiomeObjectSetValue</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#BiomeVegetationSetValue"><span class="toc-number">9.5.</span> <span class="toc-text">BiomeVegetationSetValue</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#BiomeMaterialSetValue"><span class="toc-number">9.6.</span> <span class="toc-text">BiomeMaterialSetValue</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#BiomeMaterialGetValue"><span class="toc-number">9.7.</span> <span class="toc-text">BiomeMaterialGetValue</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#BiomeMapSetSize"><span class="toc-number">9.8.</span> <span class="toc-text">BiomeMapSetSize</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#BiomeMapGetSize"><span class="toc-number">9.9.</span> <span class="toc-text">BiomeMapGetSize</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#BiomeMapSetPixel"><span class="toc-number">9.10.</span> <span class="toc-text">BiomeMapSetPixel</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#BiomeMapGetPixel"><span class="toc-number">9.11.</span> <span class="toc-text">BiomeMapGetPixel</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#BiomeMapConvertPixelFromUintToInt"><span class="toc-number">9.12.</span> <span class="toc-text">BiomeMapConvertPixelFromUintToInt</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#BiomeMapLoadImage"><span class="toc-number">9.13.</span> <span class="toc-text">BiomeMapLoadImage</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#BiomeMapLoadImageCropped"><span class="toc-number">9.14.</span> <span class="toc-text">BiomeMapLoadImageCropped</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#BiomeMapGetVerticalPositionInsideBiome"><span class="toc-number">9.15.</span> <span class="toc-text">BiomeMapGetVerticalPositionInsideBiome</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#BiomeMapGetName"><span class="toc-number">9.16.</span> <span class="toc-text">BiomeMapGetName</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#CellFactory%E2%80%A6%E2%80%A6%EF%BC%88%E5%83%8F%E7%B4%A0%EF%BC%89"><span class="toc-number">10.</span> <span class="toc-text">CellFactory……（像素）</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#CellFactory-GetName"><span class="toc-number">10.1.</span> <span class="toc-text">CellFactory_GetName</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#CellFactory-GetType"><span class="toc-number">10.2.</span> <span class="toc-text">CellFactory_GetType</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#CellFactory-GetUIName"><span class="toc-number">10.3.</span> <span class="toc-text">CellFactory_GetUIName</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#CellFactory-GetAllLiquids"><span class="toc-number">10.4.</span> <span class="toc-text">CellFactory_GetAllLiquids</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#CellFactory-GetAllSands"><span class="toc-number">10.5.</span> <span class="toc-text">CellFactory_GetAllSands</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#CellFactory-GetAllGases"><span class="toc-number">10.6.</span> <span class="toc-text">CellFactory_GetAllGases</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#CellFactory-GetAllFires"><span class="toc-number">10.7.</span> <span class="toc-text">CellFactory_GetAllFires</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#CellFactory-GetAllSolids"><span class="toc-number">10.8.</span> <span class="toc-text">CellFactory_GetAllSolids</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#CellFactory-GetTags"><span class="toc-number">10.9.</span> <span class="toc-text">CellFactory_GetTags</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#CellFactory-HasTag"><span class="toc-number">10.10.</span> <span class="toc-text">CellFactory_HasTag</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%B0%84%E7%BA%BF"><span class="toc-number">11.</span> <span class="toc-text">射线</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Raytrace"><span class="toc-number">11.1.</span> <span class="toc-text">Raytrace</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#RaytraceSurfaces"><span class="toc-number">11.2.</span> <span class="toc-text">RaytraceSurfaces</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#RaytraceSurfacesAndLiquiform"><span class="toc-number">11.3.</span> <span class="toc-text">RaytraceSurfacesAndLiquiform</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#RaytracePlatforms"><span class="toc-number">11.4.</span> <span class="toc-text">RaytracePlatforms</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%9A%8F%E6%9C%BA%E6%95%B0"><span class="toc-number">12.</span> <span class="toc-text">随机数</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Random"><span class="toc-number">12.1.</span> <span class="toc-text">Random</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Randomf"><span class="toc-number">12.2.</span> <span class="toc-text">Randomf</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#RandomDistribution"><span class="toc-number">12.3.</span> <span class="toc-text">RandomDistribution</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#RandomDistributionf"><span class="toc-number">12.4.</span> <span class="toc-text">RandomDistributionf</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#ProceduralRandom"><span class="toc-number">12.5.</span> <span class="toc-text">ProceduralRandom</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#ProceduralRandomf"><span class="toc-number">12.6.</span> <span class="toc-text">ProceduralRandomf</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#ProceduralRandomi"><span class="toc-number">12.7.</span> <span class="toc-text">ProceduralRandomi</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%88%98%E4%BA%89%E4%B9%8B%E9%9B%BE"><span class="toc-number">13.</span> <span class="toc-text">战争之雾</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#GameGetFogOfWar"><span class="toc-number">13.1.</span> <span class="toc-text">GameGetFogOfWar</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#GameGetFogOfWarBilinear"><span class="toc-number">13.2.</span> <span class="toc-text">GameGetFogOfWarBilinear</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#GameSetFogOfWar"><span class="toc-number">13.3.</span> <span class="toc-text">GameSetFogOfWar</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%85%A8%E5%B1%80%E5%8F%98%E9%87%8F"><span class="toc-number">14.</span> <span class="toc-text">全局变量</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#GameAddFlagRun"><span class="toc-number">14.1.</span> <span class="toc-text">GameAddFlagRun</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#GameRemoveFlagRun"><span class="toc-number">14.2.</span> <span class="toc-text">GameRemoveFlagRun</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#GameHasFlagRun"><span class="toc-number">14.3.</span> <span class="toc-text">GameHasFlagRun</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#GlobalsSetValue"><span class="toc-number">14.4.</span> <span class="toc-text">GlobalsSetValue</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#GlobalsGetValue"><span class="toc-number">14.5.</span> <span class="toc-text">GlobalsGetValue</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#AddFlagPersistent"><span class="toc-number">14.6.</span> <span class="toc-text">AddFlagPersistent</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#HasFlagPersistent"><span class="toc-number">14.7.</span> <span class="toc-text">HasFlagPersistent</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#RemoveFlagPersistent"><span class="toc-number">14.8.</span> <span class="toc-text">RemoveFlagPersistent</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Camera"><span class="toc-number">15.</span> <span class="toc-text">Camera</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#GameGetCameraPos"><span class="toc-number">15.1.</span> <span class="toc-text">GameGetCameraPos</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#GameSetCameraPos"><span class="toc-number">15.2.</span> <span class="toc-text">GameSetCameraPos</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#GameSetCameraFree"><span class="toc-number">15.3.</span> <span class="toc-text">GameSetCameraFree</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#GameGetCameraBounds"><span class="toc-number">15.4.</span> <span class="toc-text">GameGetCameraBounds</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%B7%B7%E4%B9%B1%E5%8F%98%E5%BD%A2"><span class="toc-number">16.</span> <span class="toc-text">混乱变形</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#PolymorphTableAddEntity"><span class="toc-number">16.1.</span> <span class="toc-text">PolymorphTableAddEntity</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#PolymorphTableRemoveEntity"><span class="toc-number">16.2.</span> <span class="toc-text">PolymorphTableRemoveEntity</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#PolymorphTableGet"><span class="toc-number">16.3.</span> <span class="toc-text">PolymorphTableGet</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#PolymorphTableSet"><span class="toc-number">16.4.</span> <span class="toc-text">PolymorphTableSet</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Herd%EF%BC%88%E9%98%B5%E8%90%A5%EF%BC%89"><span class="toc-number">17.</span> <span class="toc-text">Herd（阵营）</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#StringToHerdId"><span class="toc-number">17.1.</span> <span class="toc-text">StringToHerdId</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#HerdIdToString"><span class="toc-number">17.2.</span> <span class="toc-text">HerdIdToString</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#GetHerdRelation"><span class="toc-number">17.3.</span> <span class="toc-text">GetHerdRelation</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#EntityGetHerdRelation"><span class="toc-number">17.4.</span> <span class="toc-text">EntityGetHerdRelation</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#EntityGetHerdRelationSafe"><span class="toc-number">17.5.</span> <span class="toc-text">EntityGetHerdRelationSafe</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%85%B6%E5%AE%83"><span class="toc-number">18.</span> <span class="toc-text">其它</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#GetParallelWorldPosition"><span class="toc-number">18.1.</span> <span class="toc-text">GetParallelWorldPosition</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#IsPlayer"><span class="toc-number">18.2.</span> <span class="toc-text">IsPlayer</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#IsInvisible"><span class="toc-number">18.3.</span> <span class="toc-text">IsInvisible</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#GameIsDailyRun"><span class="toc-number">18.4.</span> <span class="toc-text">GameIsDailyRun</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#GameIsDailyRunOrDailyPracticeRun"><span class="toc-number">18.5.</span> <span class="toc-text">GameIsDailyRunOrDailyPracticeRun</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#GameIsModeFullyDeterministic"><span class="toc-number">18.6.</span> <span class="toc-text">GameIsModeFullyDeterministic</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#dofile"><span class="toc-number">18.7.</span> <span class="toc-text">dofile</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#dofile-once"><span class="toc-number">18.8.</span> <span class="toc-text">dofile_once</span></a></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/2025/09/28/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84-%E9%93%BE%E8%A1%A8%E5%AE%9E%E9%AA%8C/" title="数据结构_链表实验"><img src="/image/cover32_home.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="数据结构_链表实验"/></a><div class="content"><a class="title" href="/2025/09/28/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84-%E9%93%BE%E8%A1%A8%E5%AE%9E%E9%AA%8C/" title="数据结构_链表实验">数据结构_链表实验</a><time datetime="2025-09-28T09:50:00.000Z" title="发表于 2025-09-28 17:50:00">2025-09-28</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2025/09/26/docker-and-OCI/" title="docker registry"><img src="/image/cover31_cat.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="docker registry"/></a><div class="content"><a class="title" href="/2025/09/26/docker-and-OCI/" title="docker registry">docker registry</a><time datetime="2025-09-26T11:49:36.000Z" title="发表于 2025-09-26 19:49:36">2025-09-26</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2025/09/20/pwn_%E5%91%BD%E4%BB%A4%E9%80%9F%E6%9F%A5%EF%BC%88%E6%8C%81%E7%BB%AD%E6%9B%B4%E6%96%B0%EF%BC%89/" title="pwn“cache”"><img src="/image/cover33_book.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="pwn“cache”"/></a><div class="content"><a class="title" href="/2025/09/20/pwn_%E5%91%BD%E4%BB%A4%E9%80%9F%E6%9F%A5%EF%BC%88%E6%8C%81%E7%BB%AD%E6%9B%B4%E6%96%B0%EF%BC%89/" title="pwn“cache”">pwn“cache”</a><time datetime="2025-09-20T06:03:08.000Z" title="发表于 2025-09-20 14:03:08">2025-09-20</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2025/08/31/%E6%89%8B%E6%90%93%E4%B8%80%E4%B8%AA%E9%93%BE%E8%A1%A8/" title="手搓一个简单的链表"><img src="/image/cover30_knight.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="手搓一个简单的链表"/></a><div class="content"><a class="title" href="/2025/08/31/%E6%89%8B%E6%90%93%E4%B8%80%E4%B8%AA%E9%93%BE%E8%A1%A8/" title="手搓一个简单的链表">手搓一个简单的链表</a><time datetime="2025-08-31T05:40:11.000Z" title="发表于 2025-08-31 13:40:11">2025-08-31</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2025/08/14/%E7%81%B0%E5%A7%91%E5%A8%98/" title="睡前故事：灰姑娘"><img src="/image/cover29_flower.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="睡前故事：灰姑娘"/></a><div class="content"><a class="title" href="/2025/08/14/%E7%81%B0%E5%A7%91%E5%A8%98/" title="睡前故事：灰姑娘">睡前故事：灰姑娘</a><time datetime="2025-08-14T14:33:25.000Z" title="发表于 2025-08-14 22:33:25">2025-08-14</time></div></div></div></div></div></div></main><footer id="footer" style="background-image: url(/img/foot.jpg);"><div id="footer-wrap"><div class="copyright">&copy;2025 By Auceptin.Fang</div><div class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo 7.3.0</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly 5.3.5</a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="日间和夜间模式切换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><a id="to_comment" href="#post-comment" title="前往评论"><i class="fas fa-comments"></i></a><button id="go-up" type="button" title="回到顶部"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><div class="js-pjax"><script>(() => {
  const isShuoshuo = GLOBAL_CONFIG_SITE.pageType === 'shuoshuo'
  const option = null

  const getGiscusTheme = theme => theme === 'dark' ? 'dark' : 'light'

  const createScriptElement = config => {
    const ele = document.createElement('script')
    Object.entries(config).forEach(([key, value]) => {
      ele.setAttribute(key, value)
    })
    return ele
  }

  const loadGiscus = (el = document, key) => {
    const mappingConfig = isShuoshuo
      ? { 'data-mapping': 'specific', 'data-term': key }
      : { 'data-mapping': (option && option['data-mapping']) || 'pathname' }

    const giscusConfig = {
      src: 'https://giscus.app/client.js',
      'data-repo': 'AuceptinFang/blog',
      'data-repo-id': 'R_kgDOO_UAjA',
      'data-category-id': 'DIC_kwDOO_UAjM4Cr3mL',
      'data-theme': getGiscusTheme(document.documentElement.getAttribute('data-theme')),
      'data-reactions-enabled': '1',
      crossorigin: 'anonymous',
      async: true,
      ...option,
      ...mappingConfig
    }

    const scriptElement = createScriptElement(giscusConfig)

    el.querySelector('#giscus-wrap').appendChild(scriptElement)

    if (isShuoshuo) {
      window.shuoshuoComment.destroyGiscus = () => {
        if (el.children.length) {
          el.innerHTML = ''
          el.classList.add('no-comment')
        }
      }
    }
  }

  const changeGiscusTheme = theme => {
    const iframe = document.querySelector('#giscus-wrap iframe')
    if (iframe) {
      const message = {
        giscus: {
          setConfig: {
            theme: getGiscusTheme(theme)
          }
        }
      }
      iframe.contentWindow.postMessage(message, 'https://giscus.app')
    }
  }

  btf.addGlobalFn('themeChange', changeGiscusTheme, 'giscus')

  if (isShuoshuo) {
    'Giscus' === 'Giscus'
      ? window.shuoshuoComment = { loadComment: loadGiscus }
      : window.loadOtherComment = loadGiscus
    return
  }

  if ('Giscus' === 'Giscus' || !false) {
    if (false) btf.loadComment(document.getElementById('giscus-wrap'), loadGiscus)
    else loadGiscus()
  } else {
    window.loadOtherComment = loadGiscus
  }
})()</script></div><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></body></html>